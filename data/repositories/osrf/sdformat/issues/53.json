{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "links": {"attachments": {"href": "data/repositories/osrf/sdformat/issues/53/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/sdformat/issues/53.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/sdformat/issues/53/watch"}, "comments": {"href": "data/repositories/osrf/sdformat/issues/53/comments_page=1.json"}, "html": {"href": "#!/osrf/sdformat/issues/53/sdf_test-failure-on-osx-108"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/sdformat/issues/53/vote"}}, "reporter": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "title": "SDF_TEST failure on OSX 10.8", "component": null, "votes": 0, "watches": 1, "content": {"raw": "I am seeing a weird failure of UNIT_SDF_TEST at line\r\n[src/SDF_TEST.cc:84](#!/osrf/sdformat/src/93a9f312dfe5/src/SDF_TEST.cc#cl-84)\r\non my laptop (OSX 10.8.5):\r\n~~~\r\n$ src/UNIT_SDF_TEST \r\n[==========] Running 5 tests from 1 test case.\r\n[----------] Global test environment set-up.\r\n[----------] 5 tests from RmlUpdate\r\n[ RUN      ] RmlUpdate.UpdateAttribute\r\nWarning [parser.cc:391] Converting a deprecated SDF source[data-string].\r\nWarning [Converter.cc:59]   Version[1.3] to Version[1.4]\r\n  Please use the gzsdf tool to update your SDF files.\r\n    $ gzsdf convert [sdf_file]\r\n/Users/scpeters/ws/sdformat/src/sdformat/src/SDF_TEST.cc:84: Failure\r\nValue of: typeid(std::string)\r\n  Actual: 16-byte object <60-FB A1-73 FF-7F 00-00 20-19 14-0A 01-00 00-00>\r\nExpected: nameParam->GetType()\r\nWhich is: 16-byte object <60-FB A1-73 FF-7F 00-00 22-37 22-0A 01-00 00-00>\r\n[  FAILED  ] RmlUpdate.UpdateAttribute (41 ms)\r\n...\r\n[----------] 5 tests from RmlUpdate (171 ms total)\r\n\r\n[----------] Global test environment tear-down\r\n[==========] 5 tests from 1 test case ran. (172 ms total)\r\n[  PASSED  ] 4 tests.\r\n[  FAILED  ] 1 test, listed below:\r\n[  FAILED  ] RmlUpdate.UpdateAttribute\r\n~~~\r\nI cannot reproduce it on Ubuntu or OSX 10.9. I've identified pull request #76 (Initial work on support visibility hidden by default) as the change that causes the test failure (ie. it fails as of 93a9f312dfe5, while its parent 96181e520b83 did not have a failure).\r\n\r\nHere's the libraries the test is using:\r\n~~~\r\n$ otool -L src/UNIT_SDF_TEST \r\nsrc/UNIT_SDF_TEST:\r\n\t$HOME/ws/sdformat/build_isolated/sdformat/devel/src/libsdformat.1.dylib (compatibility version 1.0.0, current version 1.4.11)\r\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0)\r\n\t/usr/local/lib/libtinyxml.dylib (compatibility version 0.0.0, current version 0.0.0)\r\n\t/usr/local/lib/libboost_system-mt.dylib (compatibility version 0.0.0, current version 0.0.0)\r\n\t/usr/local/lib/libboost_filesystem-mt.dylib (compatibility version 0.0.0, current version 0.0.0)\r\n\t/usr/local/lib/libboost_program_options-mt.dylib (compatibility version 0.0.0, current version 0.0.0)\r\n\t/usr/local/lib/libboost_regex-mt.dylib (compatibility version 0.0.0, current version 0.0.0)\r\n\t/usr/local/lib/libboost_iostreams-mt.dylib (compatibility version 0.0.0, current version 0.0.0)\r\n\t/usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 56.0.0)\r\n~~~\r\nand the version numbers of those libraries:\r\n~~~\r\nls -l `otool -L src/UNIT_SDF_TEST | tr -d '\\t' | sed -e 's@dylib.*@dylib@'` | sed -e 's@.*\\->@@'\r\nls: src/UNIT_SDF_TEST:: No such file or directory\r\n libsdformat.1.4.11.dylib\r\n-rwxr-xr-x  1 root      wheel  53920 Jul 21  2012 /usr/lib/libSystem.B.dylib\r\n libstdc++.6.0.9.dylib\r\n ../Cellar/boost/1.55.0/lib/libboost_filesystem-mt.dylib\r\n ../Cellar/boost/1.55.0/lib/libboost_iostreams-mt.dylib\r\n ../Cellar/boost/1.55.0/lib/libboost_program_options-mt.dylib\r\n ../Cellar/boost/1.55.0/lib/libboost_regex-mt.dylib\r\n ../Cellar/boost/1.55.0/lib/libboost_system-mt.dylib\r\n ../Cellar/tinyxml/2.6.2/lib/libtinyxml.dylib\r\n~~~", "markup": "markdown", "html": "<p>I am seeing a weird failure of UNIT_SDF_TEST at line\n<a data-is-external-link=\"true\" href=\"#!/osrf/sdformat/src/93a9f312dfe5/src/SDF_TEST.cc#cl-84\" rel=\"nofollow\">src/SDF_TEST.cc:84</a>\non my laptop (OSX 10.8.5):</p>\n<div class=\"codehilite\"><pre><span></span>$ src/UNIT_SDF_TEST \n<span class=\"o\">[==========]</span> Running <span class=\"m\">5</span> tests from <span class=\"m\">1</span> <span class=\"nb\">test</span> <span class=\"k\">case</span>.\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> Global <span class=\"nb\">test</span> environment set-up.\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> <span class=\"m\">5</span> tests from RmlUpdate\n<span class=\"o\">[</span> RUN      <span class=\"o\">]</span> RmlUpdate.UpdateAttribute\nWarning <span class=\"o\">[</span>parser.cc:391<span class=\"o\">]</span> Converting a deprecated SDF source<span class=\"o\">[</span>data-string<span class=\"o\">]</span>.\nWarning <span class=\"o\">[</span>Converter.cc:59<span class=\"o\">]</span>   Version<span class=\"o\">[</span><span class=\"m\">1</span>.3<span class=\"o\">]</span> to Version<span class=\"o\">[</span><span class=\"m\">1</span>.4<span class=\"o\">]</span>\n  Please use the gzsdf tool to update your SDF files.\n    $ gzsdf convert <span class=\"o\">[</span>sdf_file<span class=\"o\">]</span>\n/Users/scpeters/ws/sdformat/src/sdformat/src/SDF_TEST.cc:84: Failure\nValue of: typeid<span class=\"o\">(</span>std::string<span class=\"o\">)</span>\n  Actual: <span class=\"m\">16</span>-byte object &lt;<span class=\"m\">60</span>-FB A1-73 FF-7F <span class=\"m\">00</span>-00 <span class=\"m\">20</span>-19 <span class=\"m\">14</span>-0A <span class=\"m\">01</span>-00 <span class=\"m\">00</span>-00&gt;\nExpected: nameParam-&gt;GetType<span class=\"o\">()</span>\nWhich is: <span class=\"m\">16</span>-byte object &lt;<span class=\"m\">60</span>-FB A1-73 FF-7F <span class=\"m\">00</span>-00 <span class=\"m\">22</span>-37 <span class=\"m\">22</span>-0A <span class=\"m\">01</span>-00 <span class=\"m\">00</span>-00&gt;\n<span class=\"o\">[</span>  FAILED  <span class=\"o\">]</span> RmlUpdate.UpdateAttribute <span class=\"o\">(</span><span class=\"m\">41</span> ms<span class=\"o\">)</span>\n...\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> <span class=\"m\">5</span> tests from RmlUpdate <span class=\"o\">(</span><span class=\"m\">171</span> ms total<span class=\"o\">)</span>\n\n<span class=\"o\">[</span>----------<span class=\"o\">]</span> Global <span class=\"nb\">test</span> environment tear-down\n<span class=\"o\">[==========]</span> <span class=\"m\">5</span> tests from <span class=\"m\">1</span> <span class=\"nb\">test</span> <span class=\"k\">case</span> ran. <span class=\"o\">(</span><span class=\"m\">172</span> ms total<span class=\"o\">)</span>\n<span class=\"o\">[</span>  PASSED  <span class=\"o\">]</span> <span class=\"m\">4</span> tests.\n<span class=\"o\">[</span>  FAILED  <span class=\"o\">]</span> <span class=\"m\">1</span> test, listed below:\n<span class=\"o\">[</span>  FAILED  <span class=\"o\">]</span> RmlUpdate.UpdateAttribute\n</pre></div>\n\n\n<p>I cannot reproduce it on Ubuntu or OSX 10.9. I've identified <a href=\"#!/osrf/sdformat/pull-requests/76/initial-work-on-support-visibility-hidden\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #76</a> (Initial work on support visibility hidden by default) as the change that causes the test failure (ie. it fails as of <a href=\"#!/osrf/sdformat/commits/93a9f312dfe5\" rel=\"nofollow\" class=\"ap-connect-link\">93a9f312dfe5</a>, while its parent <a href=\"#!/osrf/sdformat/commits/96181e520b83\" rel=\"nofollow\" class=\"ap-connect-link\">96181e520b83</a> did not have a failure).</p>\n<p>Here's the libraries the test is using:</p>\n<div class=\"codehilite\"><pre><span></span>$ otool -L src/UNIT_SDF_TEST \nsrc/UNIT_SDF_TEST:\n    <span class=\"nv\">$HOME</span>/ws/sdformat/build_isolated/sdformat/devel/src/libsdformat.1.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">1</span>.0.0, current version <span class=\"m\">1</span>.4.11<span class=\"o\">)</span>\n    /usr/lib/libSystem.B.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">1</span>.0.0, current version <span class=\"m\">169</span>.3.0<span class=\"o\">)</span>\n    /usr/local/lib/libtinyxml.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">0</span>.0.0, current version <span class=\"m\">0</span>.0.0<span class=\"o\">)</span>\n    /usr/local/lib/libboost_system-mt.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">0</span>.0.0, current version <span class=\"m\">0</span>.0.0<span class=\"o\">)</span>\n    /usr/local/lib/libboost_filesystem-mt.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">0</span>.0.0, current version <span class=\"m\">0</span>.0.0<span class=\"o\">)</span>\n    /usr/local/lib/libboost_program_options-mt.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">0</span>.0.0, current version <span class=\"m\">0</span>.0.0<span class=\"o\">)</span>\n    /usr/local/lib/libboost_regex-mt.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">0</span>.0.0, current version <span class=\"m\">0</span>.0.0<span class=\"o\">)</span>\n    /usr/local/lib/libboost_iostreams-mt.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">0</span>.0.0, current version <span class=\"m\">0</span>.0.0<span class=\"o\">)</span>\n    /usr/lib/libstdc++.6.dylib <span class=\"o\">(</span>compatibility version <span class=\"m\">7</span>.0.0, current version <span class=\"m\">56</span>.0.0<span class=\"o\">)</span>\n</pre></div>\n\n\n<p>and the version numbers of those libraries:</p>\n<div class=\"codehilite\"><pre><span></span>ls -l `otool -L src/UNIT_SDF_TEST | tr -d &#39;\\t&#39; | sed -e &#39;s@dylib.*@dylib@&#39;` | sed -e &#39;s@.*\\-&gt;@@&#39;\nls: src/UNIT_SDF_TEST:: No such file or directory\n libsdformat.1.4.11.dylib\n-rwxr-xr-x  1 root      wheel  53920 Jul 21  2012 /usr/lib/libSystem.B.dylib\n libstdc++.6.0.9.dylib\n ../Cellar/boost/1.55.0/lib/libboost_filesystem-mt.dylib\n ../Cellar/boost/1.55.0/lib/libboost_iostreams-mt.dylib\n ../Cellar/boost/1.55.0/lib/libboost_program_options-mt.dylib\n ../Cellar/boost/1.55.0/lib/libboost_regex-mt.dylib\n ../Cellar/boost/1.55.0/lib/libboost_system-mt.dylib\n ../Cellar/tinyxml/2.6.2/lib/libtinyxml.dylib\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "wontfix", "version": null, "edited_on": null, "created_on": "2014-03-19T20:52:21.550089+00:00", "milestone": null, "updated_on": "2015-02-10T20:10:53.210416+00:00", "type": "issue", "id": 53}