{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "links": {"attachments": {"href": "data/repositories/osrf/sdformat/issues/219/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/sdformat/issues/219.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/sdformat/issues/219/watch"}, "comments": {"href": "data/repositories/osrf/sdformat/issues/219/comments_page=1.json"}, "html": {"href": "#!/osrf/sdformat/issues/219/joint-axis-always-uses-parent-model-frame"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/sdformat/issues/219/vote"}}, "reporter": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "title": "Joint axis always uses parent model frame when nested", "component": null, "votes": 0, "watches": 1, "content": {"raw": "When a model is nested in another model, the joints inside the child model are parsed as though `use_parent_model_frame` is set to true even if it is not. \r\n\r\nRelevant line of code: #!/osrf/sdformat/src/sdf6/src/parser.cc#lines-1104\r\n\r\n# Steps to Reproduce\r\n\r\n1. Extract attached zip file. Place the `included_joint` folder in your gazebo model database. This can be done by copying the folder to `~/.gazebo/models`.\r\n2. Run gazebo\r\n3. Spawn the `joint_axis_test` model by running `gz model -f joint_axis_test.sdf -m joint_axis_test`\r\n\r\n**Expected behavior:**  \r\n\r\nThe model `included_joint` has one revolute joint with an axis set to `0 0 1`. This model is nested in another model as\r\n\r\n```\r\n<include>\r\n  <uri>model://included_joint</uri>\r\n  <pose>0 0 0.5 0 -1.570796 0</pose>\r\n</include>\r\n```\r\n\r\nSince `use_parent_model_frame` is not set, this vector is taken to be in the local frame of the child link `wheel`. The expected behavior is that the axis is aligned with the longitudinal direction of the cylinder.\r\n\r\n![default_gzclient_camera(1)-2019-09-04T11_02_18.648658.jpg](data/bitbucket.org/repo/ak8x4z/images/3089388943-default_gzclient_camera1-2019-09-04T11_02_18.648658.jpg)\r\n\r\n**Actual behavior:**\r\n\r\nThe axis is not aligned with the longitudinal direction of the cylinder because it is rotated by the parent model's pose.\r\n\r\n![default_gzclient_camera(1)-2019-09-04T11_01_54.664453.jpg](data/bitbucket.org/repo/ak8x4z/images/608178976-default_gzclient_camera1-2019-09-04T11_01_54.664453.jpg)\r\n\r\n**Reproduces how often:** \r\n\r\n100%\r\n\r\n# Versions\r\n\r\nall\r\n\r\n# Additional Information", "markup": "markdown", "html": "<p>When a model is nested in another model, the joints inside the child model are parsed as though <code>use_parent_model_frame</code> is set to true even if it is not. </p>\n<p>Relevant line of code: <a href=\"#!/osrf/sdformat/src/sdf6/src/parser.cc#lines-1104\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/sdformat/src/sdf6/src/parser.cc#lines-1104</a></p>\n<h1 id=\"markdown-header-steps-to-reproduce\">Steps to Reproduce</h1>\n<ol>\n<li>Extract attached zip file. Place the <code>included_joint</code> folder in your gazebo model database. This can be done by copying the folder to <code>~/.gazebo/models</code>.</li>\n<li>Run gazebo</li>\n<li>Spawn the <code>joint_axis_test</code> model by running <code>gz model -f joint_axis_test.sdf -m joint_axis_test</code></li>\n</ol>\n<p><strong>Expected behavior:</strong>  </p>\n<p>The model <code>included_joint</code> has one revolute joint with an axis set to <code>0 0 1</code>. This model is nested in another model as</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;include&gt;</span>\n  <span class=\"nt\">&lt;uri&gt;</span>model://included_joint<span class=\"nt\">&lt;/uri&gt;</span>\n  <span class=\"nt\">&lt;pose&gt;</span>0 0 0.5 0 -1.570796 0<span class=\"nt\">&lt;/pose&gt;</span>\n<span class=\"nt\">&lt;/include&gt;</span>\n</pre></div>\n\n\n<p>Since <code>use_parent_model_frame</code> is not set, this vector is taken to be in the local frame of the child link <code>wheel</code>. The expected behavior is that the axis is aligned with the longitudinal direction of the cylinder.</p>\n<p><img alt=\"default_gzclient_camera(1)-2019-09-04T11_02_18.648658.jpg\" src=\"data/bitbucket.org/repo/ak8x4z/images/3089388943-default_gzclient_camera1-2019-09-04T11_02_18.648658.jpg\" /></p>\n<p><strong>Actual behavior:</strong></p>\n<p>The axis is not aligned with the longitudinal direction of the cylinder because it is rotated by the parent model's pose.</p>\n<p><img alt=\"default_gzclient_camera(1)-2019-09-04T11_01_54.664453.jpg\" src=\"data/bitbucket.org/repo/ak8x4z/images/608178976-default_gzclient_camera1-2019-09-04T11_01_54.664453.jpg\" /></p>\n<p><strong>Reproduces how often:</strong> </p>\n<p>100%</p>\n<h1 id=\"markdown-header-versions\">Versions</h1>\n<p>all</p>\n<h1 id=\"markdown-header-additional-information\">Additional Information</h1>", "type": "rendered"}, "assignee": null, "state": "resolved", "version": null, "edited_on": null, "created_on": "2019-09-04T16:15:38.566943+00:00", "milestone": null, "updated_on": "2020-02-25T20:01:01.025400+00:00", "type": "issue", "id": 219}