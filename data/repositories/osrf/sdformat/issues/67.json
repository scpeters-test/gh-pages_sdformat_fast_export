{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "links": {"attachments": {"href": "data/repositories/osrf/sdformat/issues/67/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/sdformat/issues/67.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/sdformat/issues/67/watch"}, "comments": {"href": "data/repositories/osrf/sdformat/issues/67/comments_page=1.json"}, "html": {"href": "#!/osrf/sdformat/issues/67/pose-tag-in-sensors-ignored-with-fixed"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/sdformat/issues/67/vote"}}, "reporter": {"display_name": "adhenning", "uuid": "{aa99a57e-7bf1-4a88-ad27-a3cdd36e629c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Baa99a57e-7bf1-4a88-ad27-a3cdd36e629c%7D"}, "html": {"href": "https://bitbucket.org/%7Baa99a57e-7bf1-4a88-ad27-a3cdd36e629c%7D/"}, "avatar": {"href": "https://bitbucket.org/account/adhenning/avatar/"}}, "nickname": "adhenning", "type": "user", "account_id": null}, "title": "Pose tag in sensors ignored with fixed links", "component": null, "votes": 0, "watches": 2, "content": {"raw": "When a sensor (or at least camera's in this case) is attached to a fixed link, it's pose tag is ignored and overwritten with the computed pose for the fixed link when the pose tag should be transformed by the computed pose. I've attach the file to reproduce this issue. The following cases show the error. The pose should change, but doesn't.\r\n\r\nNo pose (0, 0, 0, 0, 0, 0):\r\n\r\n    <sensor name=\"robotCamera\" type=\"camera\">\r\n      <visualize>true</visualize>\r\n      <!-- <pose>1 1 1 1.570796 1.570796 1.570796</pose> -->\r\n      <camera></camera>\r\n    </sensor>\r\n\r\nOutput:\r\n\r\n    $ gz sdf -p /usr/share/frcsim/models/GearsBot/robots/GearsBot.URDF | awk \"/<sensor name='robotCamera/,/<\\/sensor>/\"\r\n      <sensor name='robotCamera' type='camera'>\r\n        <visualize>1</visualize>\r\n        <camera name='__default__'>\r\n          <horizontal_fov>1.047</horizontal_fov>\r\n          <image>\r\n            <width>320</width>\r\n            <height>240</height>\r\n          </image>\r\n          <clip>\r\n            <near>0.1</near>\r\n            <far>100</far>\r\n          </clip>\r\n        </camera>\r\n        <pose>-0.20115 0.42488 0.30943 1.5708 -0.89012 1.5708</pose>\r\n      </sensor>\r\n\r\nPose:\r\n\r\n    <sensor name=\"robotCamera\" type=\"camera\">\r\n      <visualize>true</visualize>\r\n      <pose>1 1 1 1.570796 1.570796 1.570796</pose>\r\n      <camera></camera>\r\n    </sensor>\r\n\r\nOutput:\r\n\r\n      $ gz sdf -p /usr/share/frcsim/models/GearsBot/robots/GearsBot.URDF | awk \"/<sensor name='robotCamera/,/<\\/sensor>/\"\r\n      <sensor name='robotCamera' type='camera'>\r\n        <visualize>1</visualize>\r\n        <camera name='__default__'>\r\n          <horizontal_fov>1.047</horizontal_fov>\r\n          <image>\r\n            <width>320</width>\r\n            <height>240</height>\r\n          </image>\r\n          <clip>\r\n            <near>0.1</near>\r\n            <far>100</far>\r\n          </clip>\r\n        </camera>\r\n        <pose>-0.20115 0.42488 0.30943 1.5708 -0.89012 1.5708</pose>\r\n      </sensor>", "markup": "markdown", "html": "<p>When a sensor (or at least camera's in this case) is attached to a fixed link, it's pose tag is ignored and overwritten with the computed pose for the fixed link when the pose tag should be transformed by the computed pose. I've attach the file to reproduce this issue. The following cases show the error. The pose should change, but doesn't.</p>\n<p>No pose (0, 0, 0, 0, 0, 0):</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&quot;robotCamera&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;camera&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;visualize&gt;</span>true<span class=\"nt\">&lt;/visualize&gt;</span>\n  <span class=\"c\">&lt;!-- &lt;pose&gt;1 1 1 1.570796 1.570796 1.570796&lt;/pose&gt; --&gt;</span>\n  <span class=\"nt\">&lt;camera&gt;&lt;/camera&gt;</span>\n<span class=\"nt\">&lt;/sensor&gt;</span>\n</pre></div>\n\n\n<p>Output:</p>\n<div class=\"codehilite\"><pre><span></span>$ gz sdf -p /usr/share/frcsim/models/GearsBot/robots/GearsBot.URDF | awk &quot;/<span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&#39;robotCamera/,/&lt;\\/sensor&gt;/&quot;</span>\n<span class=\"s\">  &lt;sensor name=&#39;</span><span class=\"err\">robotCamera&#39;</span> <span class=\"na\">type=</span><span class=\"s\">&#39;camera&#39;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;visualize&gt;</span>1<span class=\"nt\">&lt;/visualize&gt;</span>\n    <span class=\"nt\">&lt;camera</span> <span class=\"na\">name=</span><span class=\"s\">&#39;__default__&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;horizontal_fov&gt;</span>1.047<span class=\"nt\">&lt;/horizontal_fov&gt;</span>\n      <span class=\"nt\">&lt;image&gt;</span>\n        <span class=\"nt\">&lt;width&gt;</span>320<span class=\"nt\">&lt;/width&gt;</span>\n        <span class=\"nt\">&lt;height&gt;</span>240<span class=\"nt\">&lt;/height&gt;</span>\n      <span class=\"nt\">&lt;/image&gt;</span>\n      <span class=\"nt\">&lt;clip&gt;</span>\n        <span class=\"nt\">&lt;near&gt;</span>0.1<span class=\"nt\">&lt;/near&gt;</span>\n        <span class=\"nt\">&lt;far&gt;</span>100<span class=\"nt\">&lt;/far&gt;</span>\n      <span class=\"nt\">&lt;/clip&gt;</span>\n    <span class=\"nt\">&lt;/camera&gt;</span>\n    <span class=\"nt\">&lt;pose&gt;</span>-0.20115 0.42488 0.30943 1.5708 -0.89012 1.5708<span class=\"nt\">&lt;/pose&gt;</span>\n  <span class=\"nt\">&lt;/sensor&gt;</span>\n</pre></div>\n\n\n<p>Pose:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&quot;robotCamera&quot;</span> <span class=\"na\">type=</span><span class=\"s\">&quot;camera&quot;</span><span class=\"nt\">&gt;</span>\n  <span class=\"nt\">&lt;visualize&gt;</span>true<span class=\"nt\">&lt;/visualize&gt;</span>\n  <span class=\"nt\">&lt;pose&gt;</span>1 1 1 1.570796 1.570796 1.570796<span class=\"nt\">&lt;/pose&gt;</span>\n  <span class=\"nt\">&lt;camera&gt;&lt;/camera&gt;</span>\n<span class=\"nt\">&lt;/sensor&gt;</span>\n</pre></div>\n\n\n<p>Output:</p>\n<div class=\"codehilite\"><pre><span></span>  $ gz sdf -p /usr/share/frcsim/models/GearsBot/robots/GearsBot.URDF | awk &quot;/<span class=\"nt\">&lt;sensor</span> <span class=\"na\">name=</span><span class=\"s\">&#39;robotCamera/,/&lt;\\/sensor&gt;/&quot;</span>\n<span class=\"s\">  &lt;sensor name=&#39;</span><span class=\"err\">robotCamera&#39;</span> <span class=\"na\">type=</span><span class=\"s\">&#39;camera&#39;</span><span class=\"nt\">&gt;</span>\n    <span class=\"nt\">&lt;visualize&gt;</span>1<span class=\"nt\">&lt;/visualize&gt;</span>\n    <span class=\"nt\">&lt;camera</span> <span class=\"na\">name=</span><span class=\"s\">&#39;__default__&#39;</span><span class=\"nt\">&gt;</span>\n      <span class=\"nt\">&lt;horizontal_fov&gt;</span>1.047<span class=\"nt\">&lt;/horizontal_fov&gt;</span>\n      <span class=\"nt\">&lt;image&gt;</span>\n        <span class=\"nt\">&lt;width&gt;</span>320<span class=\"nt\">&lt;/width&gt;</span>\n        <span class=\"nt\">&lt;height&gt;</span>240<span class=\"nt\">&lt;/height&gt;</span>\n      <span class=\"nt\">&lt;/image&gt;</span>\n      <span class=\"nt\">&lt;clip&gt;</span>\n        <span class=\"nt\">&lt;near&gt;</span>0.1<span class=\"nt\">&lt;/near&gt;</span>\n        <span class=\"nt\">&lt;far&gt;</span>100<span class=\"nt\">&lt;/far&gt;</span>\n      <span class=\"nt\">&lt;/clip&gt;</span>\n    <span class=\"nt\">&lt;/camera&gt;</span>\n    <span class=\"nt\">&lt;pose&gt;</span>-0.20115 0.42488 0.30943 1.5708 -0.89012 1.5708<span class=\"nt\">&lt;/pose&gt;</span>\n  <span class=\"nt\">&lt;/sensor&gt;</span>\n</pre></div>", "type": "rendered"}, "assignee": null, "state": "new", "version": null, "edited_on": null, "created_on": "2014-07-03T18:21:16.023428+00:00", "milestone": null, "updated_on": "2014-07-03T18:28:07.134451+00:00", "type": "issue", "id": 67}