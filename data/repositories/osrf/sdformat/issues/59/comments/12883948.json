{"links": {"self": {"href": "data/repositories/osrf/sdformat/issues/59/comments/12883948.json"}, "html": {"href": "#!/osrf/sdformat/issues/59#comment-12883948"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/sdformat/issues/59.json"}}, "type": "issue", "id": 59, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "title": "Embedded copy of urdfdom is outdated"}, "content": {"raw": "I made some fixes in 6a3db10 (branch `update_urdfdom_0.3_jrivero`) for getting the branch to compile.\n\nWe need to fix a couple of invalid pointers in tests.\n```\n[==========] Running 3 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 3 tests from SDFParser\n[ RUN      ] SDFParser.FixedJointReductionEquivalenceTest\n*** Error in `/home/jrivero/code/sdformat3/build/test/integration/INTEGRATION_fixed_joint_reduction': free(): invalid pointer: 0x000000000088c7c0 ***\n\nProgram received signal SIGABRT, Aborted.\n0x00007ffff54d8077 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n56\t../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff54d8077 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n#1  0x00007ffff54d9458 in __GI_abort () at abort.c:89\n#2  0x00007ffff5515fb4 in __libc_message (do_abort=do_abort@entry=1, fmt=fmt@entry=0x7ffff5608bc0 \"*** Error in `%s': %s: 0x%s ***\\n\") at ../sysdeps/posix/libc_fatal.c:175\n#3  0x00007ffff551b78e in malloc_printerr (action=1, str=0x7ffff5604c7e \"free(): invalid pointer\", ptr=<optimized out>) at malloc.c:4996\n#4  0x00007ffff551c496 in _int_free (av=<optimized out>, p=<optimized out>, have_lock=0) at malloc.c:3840\n#5  0x00007ffff7b5a7f2 in boost::checked_delete<std::vector<boost::shared_ptr<urdf::Visual>, std::allocator<boost::shared_ptr<urdf::Visual> > > > (x=0x88c7c0)\n    at /usr/include/boost/checked_delete.hpp:34\n#6  0x00007ffff7b5d21e in boost::detail::sp_counted_impl_p<std::vector<boost::shared_ptr<urdf::Visual>, std::allocator<boost::shared_ptr<urdf::Visual> > > >::dispose (this=0x861f20)\n    at /usr/include/boost/smart_ptr/detail/sp_counted_impl.hpp:78\n#7  0x00007ffff7b0ce40 in boost::detail::sp_counted_base::release (this=0x861f20) at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:146\n#8  0x00007ffff7b0cecf in boost::detail::shared_count::~shared_count (this=0x7fffffffca18, __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/detail/shared_count.hpp:371\n#9  0x00007ffff7b52170 in boost::shared_ptr<std::vector<boost::shared_ptr<urdf::Visual>, std::allocator<boost::shared_ptr<urdf::Visual> > > >::~shared_ptr (this=0x7fffffffca10, \n    __in_chrg=<optimized out>) at /usr/include/boost/smart_ptr/shared_ptr.hpp:328\n#10 0x00007ffff7b3bc7a in ReduceVisualToParent (_link=..., _groupName=\"lump::link3a\", _visual=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:400\n#11 0x00007ffff7b3fad3 in ReduceVisualsToParent (_link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:926\n#12 0x00007ffff7b3c11d in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:427\n#13 0x00007ffff7b3bdc0 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:412\n#14 0x00007ffff7b3bdc0 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:412\n#15 0x00007ffff7b3c220 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:435\n#16 0x00007ffff7b3c220 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:435\n#17 0x00007ffff7b4dd54 in sdf::URDF2SDF::InitModelString (this=0x7fffffffd65f, \n    _urdfStr=\"<?xml version=\\\"1.0\\\" ?><robot name=\\\"fixed_joint_reduction_test_odel\\\"><link name=\\\"world\\\" /><joint name=\\\"jointw0\\\" type=\\\"continuous\\\"><origin rpy=\\\"0 0 1.57079632679\\\" xyz=\\\"0 0 1.0\\\" /><axis xyz=\\\"1 0 0\\\" /><!-\"..., _enforceLimits=true) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:2798\n#18 0x00007ffff7b4e143 in sdf::URDF2SDF::InitModelDoc (this=0x7fffffffd65f, _xmlDoc=0x7fffffffd4a0) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:2841\n#19 0x00007ffff7b4e212 in sdf::URDF2SDF::InitModelFile (this=0x7fffffffd65f, _filename=\"/home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.urdf\")\n    at /home/jrivero/code/sdformat3/src/parser_urdf.cc:2850\n#20 0x00007ffff7b27fa5 in sdf::readFile (_filename=\"/home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.urdf\", _sdf=...)\n    at /home/jrivero/code/sdformat3/src/parser.cc:270\n#21 0x0000000000418cc1 in FixedJointReductionEquivalence (_file=\"/home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.urdf\")\n    at /home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.cc:63\n#22 0x0000000000418aee in SDFParser_FixedJointReductionEquivalenceTest_Test::TestBody (this=0x67cce0) at /home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.cc:41\n```", "markup": "markdown", "html": "<p>I made some fixes in <a href=\"#!/osrf/sdformat/commits/6a3db10\" rel=\"nofollow\" class=\"ap-connect-link\">6a3db10</a> (branch <code>update_urdfdom_0.3_jrivero</code>) for getting the branch to compile.</p>\n<p>We need to fix a couple of invalid pointers in tests.</p>\n<div class=\"codehilite\"><pre><span></span>[==========] Running 3 tests from 1 test case.\n[----------] Global test environment set-up.\n[----------] 3 tests from SDFParser\n[ RUN      ] SDFParser.FixedJointReductionEquivalenceTest\n*** Error in `/home/jrivero/code/sdformat3/build/test/integration/INTEGRATION_fixed_joint_reduction&#39;: free(): invalid pointer: 0x000000000088c7c0 ***\n\nProgram received signal SIGABRT, Aborted.\n0x00007ffff54d8077 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n56  ../nptl/sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff54d8077 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56\n#1  0x00007ffff54d9458 in __GI_abort () at abort.c:89\n#2  0x00007ffff5515fb4 in __libc_message (do_abort=do_abort@entry=1, fmt=fmt@entry=0x7ffff5608bc0 &quot;*** Error in `%s&#39;: %s: 0x%s ***\\n&quot;) at ../sysdeps/posix/libc_fatal.c:175\n#3  0x00007ffff551b78e in malloc_printerr (action=1, str=0x7ffff5604c7e &quot;free(): invalid pointer&quot;, ptr=&lt;optimized out&gt;) at malloc.c:4996\n#4  0x00007ffff551c496 in _int_free (av=&lt;optimized out&gt;, p=&lt;optimized out&gt;, have_lock=0) at malloc.c:3840\n#5  0x00007ffff7b5a7f2 in boost::checked_delete&lt;std::vector&lt;boost::shared_ptr&lt;urdf::Visual&gt;, std::allocator&lt;boost::shared_ptr&lt;urdf::Visual&gt; &gt; &gt; &gt; (x=0x88c7c0)\n    at /usr/include/boost/checked_delete.hpp:34\n#6  0x00007ffff7b5d21e in boost::detail::sp_counted_impl_p&lt;std::vector&lt;boost::shared_ptr&lt;urdf::Visual&gt;, std::allocator&lt;boost::shared_ptr&lt;urdf::Visual&gt; &gt; &gt; &gt;::dispose (this=0x861f20)\n    at /usr/include/boost/smart_ptr/detail/sp_counted_impl.hpp:78\n#7  0x00007ffff7b0ce40 in boost::detail::sp_counted_base::release (this=0x861f20) at /usr/include/boost/smart_ptr/detail/sp_counted_base_gcc_x86.hpp:146\n#8  0x00007ffff7b0cecf in boost::detail::shared_count::~shared_count (this=0x7fffffffca18, __in_chrg=&lt;optimized out&gt;) at /usr/include/boost/smart_ptr/detail/shared_count.hpp:371\n#9  0x00007ffff7b52170 in boost::shared_ptr&lt;std::vector&lt;boost::shared_ptr&lt;urdf::Visual&gt;, std::allocator&lt;boost::shared_ptr&lt;urdf::Visual&gt; &gt; &gt; &gt;::~shared_ptr (this=0x7fffffffca10, \n    __in_chrg=&lt;optimized out&gt;) at /usr/include/boost/smart_ptr/shared_ptr.hpp:328\n#10 0x00007ffff7b3bc7a in ReduceVisualToParent (_link=..., _groupName=&quot;lump::link3a&quot;, _visual=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:400\n#11 0x00007ffff7b3fad3 in ReduceVisualsToParent (_link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:926\n#12 0x00007ffff7b3c11d in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:427\n#13 0x00007ffff7b3bdc0 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:412\n#14 0x00007ffff7b3bdc0 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:412\n#15 0x00007ffff7b3c220 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:435\n#16 0x00007ffff7b3c220 in ReduceFixedJoints (_root=0x87f410, _link=...) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:435\n#17 0x00007ffff7b4dd54 in sdf::URDF2SDF::InitModelString (this=0x7fffffffd65f, \n    _urdfStr=&quot;&lt;?xml version=\\&quot;1.0\\&quot; ?&gt;&lt;robot name=\\&quot;fixed_joint_reduction_test_odel\\&quot;&gt;&lt;link name=\\&quot;world\\&quot; /&gt;&lt;joint name=\\&quot;jointw0\\&quot; type=\\&quot;continuous\\&quot;&gt;&lt;origin rpy=\\&quot;0 0 1.57079632679\\&quot; xyz=\\&quot;0 0 1.0\\&quot; /&gt;&lt;axis xyz=\\&quot;1 0 0\\&quot; /&gt;&lt;!-&quot;..., _enforceLimits=true) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:2798\n#18 0x00007ffff7b4e143 in sdf::URDF2SDF::InitModelDoc (this=0x7fffffffd65f, _xmlDoc=0x7fffffffd4a0) at /home/jrivero/code/sdformat3/src/parser_urdf.cc:2841\n#19 0x00007ffff7b4e212 in sdf::URDF2SDF::InitModelFile (this=0x7fffffffd65f, _filename=&quot;/home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.urdf&quot;)\n    at /home/jrivero/code/sdformat3/src/parser_urdf.cc:2850\n#20 0x00007ffff7b27fa5 in sdf::readFile (_filename=&quot;/home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.urdf&quot;, _sdf=...)\n    at /home/jrivero/code/sdformat3/src/parser.cc:270\n#21 0x0000000000418cc1 in FixedJointReductionEquivalence (_file=&quot;/home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.urdf&quot;)\n    at /home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.cc:63\n#22 0x0000000000418aee in SDFParser_FixedJointReductionEquivalenceTest_Test::TestBody (this=0x67cce0) at /home/jrivero/code/sdformat3/test/integration/fixed_joint_reduction.cc:41\n</pre></div>", "type": "rendered"}, "created_on": "2014-10-10T01:49:49.796610+00:00", "user": {"display_name": "Jose Luis Rivero", "uuid": "{d12309b2-f745-42ee-b119-aec4fcdf81fe}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D"}, "html": {"href": "https://bitbucket.org/%7Bd12309b2-f745-42ee-b119-aec4fcdf81fe%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/109284c8b83411dbc7492138f6167e9ed=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsJR-5.png"}}, "nickname": "Jose Luis Rivero", "type": "user", "account_id": "557058:155a32e2-420c-4d50-98e0-0e722f63f906"}, "updated_on": null, "type": "issue_comment", "id": 12883948}