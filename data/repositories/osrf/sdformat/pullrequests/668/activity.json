{"pagelen": 50, "values": [{"approval": {"date": "2020-03-18T00:30:20.442992+00:00", "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/140538231.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-140538231"}}, "parent": {"id": 140534522, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/140534522.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-140534522"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "ea1ac25", "markup": "markdown", "html": "<p><a href=\"#!/osrf/sdformat/commits/ea1ac25\" rel=\"nofollow\" class=\"ap-connect-link\">ea1ac25</a></p>", "type": "rendered"}, "created_on": "2020-03-17T16:34:19.645336+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-03-17T16:34:19.654215+00:00", "type": "pullrequest_comment", "id": 140538231}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "c058c35d6532", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/c058c35d6532.json"}, "html": {"href": "#!/osrf/sdformat/commits/c058c35d6532"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "ea1ac25cc845", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/ea1ac25cc845.json"}, "html": {"href": "#!/osrf/sdformat/commits/ea1ac25cc845"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-03-17T16:33:52.143607+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/140534522.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-140534522"}}, "parent": {"id": 139762561, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/139762561.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-139762561"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Thanks @{557058:5de38267-b118-494c-aa76-4fab35448816}, that's much cleaner.", "markup": "markdown", "html": "<p>Thanks <span class=\"ap-mention\" data-atlassian-id=\"557058:5de38267-b118-494c-aa76-4fab35448816\">@Steve Peters</span>, that's much cleaner.</p>", "type": "rendered"}, "created_on": "2020-03-17T16:18:39.805734+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-03-17T16:18:39.823499+00:00", "type": "pullrequest_comment", "id": 140534522}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/139762561.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-139762561"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "reading through the new code in `addNestedModel` in parser.cc, I noticed a few places where the code could be simplified. I've put these changes in a branch; please consider merging them in here:\n\n* 277187111b59 (branch [nested_models_with_frames_scpeters](#!/osrf/sdformat/branch/nested_models_with_frames_scpeters?dest=nested_models_with_frames#diff))", "markup": "markdown", "html": "<p>reading through the new code in <code>addNestedModel</code> in parser.cc, I noticed a few places where the code could be simplified. I've put these changes in a branch; please consider merging them in here:</p>\n<ul>\n<li><a href=\"#!/osrf/sdformat/commits/277187111b59\" rel=\"nofollow\" class=\"ap-connect-link\">277187111b59</a> (branch <a data-is-external-link=\"true\" href=\"#!/osrf/sdformat/branch/nested_models_with_frames_scpeters?dest=nested_models_with_frames#diff\" rel=\"nofollow\">nested_models_with_frames_scpeters</a>)</li>\n</ul>", "type": "rendered"}, "created_on": "2020-03-12T05:48:33.320538+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2020-03-12T05:48:33.330007+00:00", "type": "pullrequest_comment", "id": 139762561}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/139325828.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-139325828"}}, "parent": {"id": 139125905, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/139125905.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-139125905"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "You're right, it should only apply to links. a8fad4c.", "markup": "markdown", "html": "<p>You're right, it should only apply to links. <a href=\"#!/osrf/sdformat/commits/a8fad4c\" rel=\"nofollow\" class=\"ap-connect-link\">a8fad4c</a>.</p>", "type": "rendered"}, "created_on": "2020-03-10T00:24:29.122708+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2020-03-10T00:24:29.129667+00:00", "type": "pullrequest_comment", "id": 139325828}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "a8fad4c7e1b5", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/a8fad4c7e1b5.json"}, "html": {"href": "#!/osrf/sdformat/commits/a8fad4c7e1b5"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-03-10T00:23:12.190430+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/139125905.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-139125905"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Should this logic be applied to joints? It looks like it should only apply to links. I think we are missing a test case with a joint with an empty `//pose/@relative_to` that I believe would show the error of this logic", "markup": "markdown", "html": "<p>Should this logic be applied to joints? It looks like it should only apply to links. I think we are missing a test case with a joint with an empty <code>//pose/@relative_to</code> that I believe would show the error of this logic</p>", "type": "rendered"}, "created_on": "2020-03-08T05:35:46.745068+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2020-03-08T05:35:46.756099+00:00", "type": "pullrequest_comment", "id": 139125905}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "76093977768e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/76093977768e.json"}, "html": {"href": "#!/osrf/sdformat/commits/76093977768e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2020-03-07T20:24:33.460246+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "76093977768e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/76093977768e.json"}, "html": {"href": "#!/osrf/sdformat/commits/76093977768e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2020-03-07T20:24:33.033010+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/139063464.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-139063464"}}, "parent": {"id": 138873944, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138873944.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138873944"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "1a5c5b5", "markup": "markdown", "html": "<p><a href=\"#!/osrf/sdformat/commits/1a5c5b5\" rel=\"nofollow\" class=\"ap-connect-link\">1a5c5b5</a></p>", "type": "rendered"}, "created_on": "2020-03-06T16:34:14.835565+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-03-06T16:34:14.855054+00:00", "type": "pullrequest_comment", "id": 139063464}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "cf86cb501fa4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/cf86cb501fa4.json"}, "html": {"href": "#!/osrf/sdformat/commits/cf86cb501fa4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-03-06T16:33:20.795773+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "1a5c5b571963", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/1a5c5b571963.json"}, "html": {"href": "#!/osrf/sdformat/commits/1a5c5b571963"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-03-06T16:31:27.543244+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138873944.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138873944"}}, "parent": {"id": 138683091, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138683091.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138683091"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Good catch. I don't think this is being handled properly. I'm working on that now.", "markup": "markdown", "html": "<p>Good catch. I don't think this is being handled properly. I'm working on that now.</p>", "type": "rendered"}, "created_on": "2020-03-05T16:41:23.140479+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-03-05T16:41:23.154112+00:00", "type": "pullrequest_comment", "id": 138873944}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138873807.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138873807"}}, "parent": {"id": 138682362, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138682362.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138682362"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "f2fb5e3", "markup": "markdown", "html": "<p><a href=\"#!/osrf/sdformat/commits/f2fb5e3\" rel=\"nofollow\" class=\"ap-connect-link\">f2fb5e3</a></p>", "type": "rendered"}, "created_on": "2020-03-05T16:40:46.649120+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2020-03-05T16:40:46.664960+00:00", "type": "pullrequest_comment", "id": 138873807}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138873696.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138873696"}}, "parent": {"id": 137864625, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137864625.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137864625"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "I've added a direct string comparison in 6d9a353. I ended up modifying modifying the output to remove elements that get added during parsing.", "markup": "markdown", "html": "<p>I've added a direct string comparison in <a href=\"#!/osrf/sdformat/commits/6d9a353\" rel=\"nofollow\" class=\"ap-connect-link\">6d9a353</a>. I ended up modifying modifying the output to remove elements that get added during parsing.</p>", "type": "rendered"}, "created_on": "2020-03-05T16:40:16.138960+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-03-05T16:40:16.154673+00:00", "type": "pullrequest_comment", "id": 138873696}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138872865.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138872865"}}, "parent": {"id": 137862872, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137862872.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137862872"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Poses in `//visual` and `//collision` using `__model__` as their relative_to were not being handled. Instead of iterating through all of those, I'm using the replace mechanism to replace all instances of `__model__` with `<model_name>::__model__`. b49fffe", "markup": "markdown", "html": "<p>Poses in <code>//visual</code> and <code>//collision</code> using <code>__model__</code> as their relative_to were not being handled. Instead of iterating through all of those, I'm using the replace mechanism to replace all instances of <code>__model__</code> with <code>&lt;model_name&gt;::__model__</code>. <a href=\"#!/osrf/sdformat/commits/b49fffe\" rel=\"nofollow\" class=\"ap-connect-link\">b49fffe</a></p>", "type": "rendered"}, "created_on": "2020-03-05T16:36:28.055173+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2020-03-05T16:36:28.073872+00:00", "type": "pullrequest_comment", "id": 138872865}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "f2fb5e38356c", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f2fb5e38356c.json"}, "html": {"href": "#!/osrf/sdformat/commits/f2fb5e38356c"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-03-05T16:31:40.442704+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138688950.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138688950"}}, "parent": {"id": 137865706, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137865706.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137865706"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "I've added a test to illustrate this in 208e02cd3cef ([branch addNestedModel_name_collision](#!/osrf/sdformat/branch/addNestedModel_name_collision))", "markup": "markdown", "html": "<p>I've added a test to illustrate this in <a href=\"#!/osrf/sdformat/commits/208e02cd3cef\" rel=\"nofollow\" class=\"ap-connect-link\">208e02cd3cef</a> (<a data-is-external-link=\"true\" href=\"#!/osrf/sdformat/branch/addNestedModel_name_collision\" rel=\"nofollow\">branch addNestedModel_name_collision</a>)</p>", "type": "rendered"}, "created_on": "2020-03-04T19:23:08.282659+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2020-03-04T19:23:08.292810+00:00", "type": "pullrequest_comment", "id": 138688950}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "bbc2846b5708", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/bbc2846b5708.json"}, "html": {"href": "#!/osrf/sdformat/commits/bbc2846b5708"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2020-03-04T18:50:27.204185+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "f01b2f0a7ff4", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/f01b2f0a7ff4.json"}, "html": {"href": "#!/osrf/sdformat/commits/f01b2f0a7ff4"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "bbc2846b5708", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/bbc2846b5708.json"}, "html": {"href": "#!/osrf/sdformat/commits/bbc2846b5708"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2020-03-04T18:50:26.213510+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138683091.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138683091"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "do we handle the case when `//include/pose/@relative_to` is set? I think that is permitted by the spec, but I didn't see it handled in the changes to `addNestedModel`", "markup": "markdown", "html": "<p>do we handle the case when <code>//include/pose/@relative_to</code> is set? I think that is permitted by the spec, but I didn't see it handled in the changes to <code>addNestedModel</code></p>", "type": "rendered"}, "created_on": "2020-03-04T18:41:07.599548+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2020-03-04T18:41:07.614771+00:00", "type": "pullrequest_comment", "id": 138683091}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138682362.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138682362"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "bump this up to an `else if`?", "markup": "markdown", "html": "<p>bump this up to an <code>else if</code>?</p>", "type": "rendered"}, "created_on": "2020-03-04T18:36:00.379320+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2020-03-04T18:36:00.386874+00:00", "type": "pullrequest_comment", "id": 138682362}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138680263.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138680263"}}, "parent": {"id": 137863015, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137863015.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137863015"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "per f2f, it happens in the code discussed by the following comment:\n\n* #!/osrf/sdformat/pull-requests/668/support-frame-semantics-in-for-models/diff#comment-137865706", "markup": "markdown", "html": "<p>per f2f, it happens in the code discussed by the following comment:</p>\n<ul>\n<li><a href=\"#!/osrf/sdformat/pull-requests/668/support-frame-semantics-in-for-models/diff#comment-137865706\" rel=\"nofollow\" class=\"ap-connect-link\">#!/osrf/sdformat/pull-requests/668/support-frame-semantics-in-for-models/diff#comment-137865706</a></li>\n</ul>", "type": "rendered"}, "created_on": "2020-03-04T18:20:27.256377+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "inline": {}, "updated_on": "2020-03-04T18:20:27.262662+00:00", "type": "pullrequest_comment", "id": 138680263}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/138680001.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-138680001"}}, "parent": {"id": 137864625, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137864625.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137864625"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "+1", "markup": "markdown", "html": "<p>+1</p>", "type": "rendered"}, "created_on": "2020-03-04T18:18:47.699834+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2020-03-04T18:18:47.710350+00:00", "type": "pullrequest_comment", "id": 138680001}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137865706.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137865706"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Per f2f, there could be a bug where collision names might be renamed to the nested name accidentally.\n\ne.g. in included model \u201cmid\\_model\u201d, we have link name \u201ca\u201d, with collision name \u201ca\u201d.\n\nCorrect behavior \\(for merging approach\\) would be to have \u201cmid\\_model::a\u201d, with collision \u201ca\u201d.\n\nCurrent text replacement will have link \u201cmid\\_model::a\u201d with collision \u201cmid\\_model::a\u201d, which is a bug, but minor.\n\nCould also have issues where a link is named \u201cfixed\u201d, and then joint types get replaced\u2026", "markup": "markdown", "html": "<p>Per f2f, there could be a bug where collision names might be renamed to the nested name accidentally.</p>\n<p>e.g. in included model \u201cmid_model\u201d, we have link name \u201ca\u201d, with collision name \u201ca\u201d.</p>\n<p>Correct behavior (for merging approach) would be to have \u201cmid_model::a\u201d, with collision \u201ca\u201d.</p>\n<p>Current text replacement will have link \u201cmid_model::a\u201d with collision \u201cmid_model::a\u201d, which is a bug, but minor.</p>\n<p>Could also have issues where a link is named \u201cfixed\u201d, and then joint types get replaced\u2026</p>", "type": "rendered"}, "created_on": "2020-02-27T19:18:38.220146+00:00", "user": {"display_name": "Eric Cousineau", "uuid": "{71c9fc05-02c8-45e1-adfa-13c8ac3399dc}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D"}, "html": {"href": "https://bitbucket.org/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557057:f3a199b9-5784-4964-9644-6ef224bc7dc1/28a4d748-0fd4-4038-bf3d-55a77eb73ede/128"}}, "nickname": "eacousineau", "type": "user", "account_id": "557057:f3a199b9-5784-4964-9644-6ef224bc7dc1"}, "inline": {}, "updated_on": "2020-02-27T19:19:27.679181+00:00", "type": "pullrequest_comment", "id": 137865706}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137864625.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137864625"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Per f2f, would be nice to see the above \u201ctransformed example\u201d as a regression test on an expected output file.", "markup": "markdown", "html": "<p>Per f2f, would be nice to see the above \u201ctransformed example\u201d as a regression test on an expected output file.</p>", "type": "rendered"}, "created_on": "2020-02-27T19:10:15.496060+00:00", "user": {"display_name": "Eric Cousineau", "uuid": "{71c9fc05-02c8-45e1-adfa-13c8ac3399dc}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D"}, "html": {"href": "https://bitbucket.org/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557057:f3a199b9-5784-4964-9644-6ef224bc7dc1/28a4d748-0fd4-4038-bf3d-55a77eb73ede/128"}}, "nickname": "eacousineau", "type": "user", "account_id": "557057:f3a199b9-5784-4964-9644-6ef224bc7dc1"}, "updated_on": "2020-02-27T19:10:15.502548+00:00", "type": "pullrequest_comment", "id": 137864625}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137863015.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137863015"}}, "parent": {"id": 137862751, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137862751.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137862751"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "I see that in the above example, there\u2019s the new transformed pose:\n\n```\n      <link name='M1::L2'>\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\n      </link>\n```\n\nHowever, I\u2019m not sure where this happens in the code.", "markup": "markdown", "html": "<p>I see that in the above example, there\u2019s the new transformed pose:</p>\n<div class=\"codehilite\"><pre><span></span>      <span class=\"nt\">&lt;link</span> <span class=\"na\">name=</span><span class=\"s\">&#39;M1::L2&#39;</span><span class=\"nt\">&gt;</span>\n        <span class=\"nt\">&lt;pose</span> <span class=\"na\">relative_to=</span><span class=\"s\">&#39;M1::F1&#39;</span><span class=\"nt\">&gt;</span>1 0 0 0 -0 0<span class=\"nt\">&lt;/pose&gt;</span>\n      <span class=\"nt\">&lt;/link&gt;</span>\n</pre></div>\n\n\n<p>However, I\u2019m not sure where this happens in the code.</p>", "type": "rendered"}, "created_on": "2020-02-27T18:58:06.455522+00:00", "user": {"display_name": "Eric Cousineau", "uuid": "{71c9fc05-02c8-45e1-adfa-13c8ac3399dc}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D"}, "html": {"href": "https://bitbucket.org/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557057:f3a199b9-5784-4964-9644-6ef224bc7dc1/28a4d748-0fd4-4038-bf3d-55a77eb73ede/128"}}, "nickname": "eacousineau", "type": "user", "account_id": "557057:f3a199b9-5784-4964-9644-6ef224bc7dc1"}, "inline": {}, "updated_on": "2020-02-27T18:58:06.479080+00:00", "type": "pullrequest_comment", "id": 137863015}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137862872.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137862872"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "What about any element that has a pose element? e.g. `//visual`, `//collision`, sensors?\n\nShould all of those be iterated through?", "markup": "markdown", "html": "<p>What about any element that has a pose element? e.g. <code>//visual</code>, <code>//collision</code>, sensors?</p>\n<p>Should all of those be iterated through?</p>", "type": "rendered"}, "created_on": "2020-02-27T18:57:04.443832+00:00", "user": {"display_name": "Eric Cousineau", "uuid": "{71c9fc05-02c8-45e1-adfa-13c8ac3399dc}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D"}, "html": {"href": "https://bitbucket.org/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557057:f3a199b9-5784-4964-9644-6ef224bc7dc1/28a4d748-0fd4-4038-bf3d-55a77eb73ede/128"}}, "nickname": "eacousineau", "type": "user", "account_id": "557057:f3a199b9-5784-4964-9644-6ef224bc7dc1"}, "inline": {}, "updated_on": "2020-02-27T18:57:04.450506+00:00", "type": "pullrequest_comment", "id": 137862872}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137862751.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137862751"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Is this missing a clause to prepend `modelName + \"::\"` for `//link/pose/@relative_to` and `//joint/pose/@relative_to`?", "markup": "markdown", "html": "<p>Is this missing a clause to prepend <code>modelName + \"::\"</code> for <code>//link/pose/@relative_to</code> and <code>//joint/pose/@relative_to</code>?</p>", "type": "rendered"}, "created_on": "2020-02-27T18:56:14.166115+00:00", "user": {"display_name": "Eric Cousineau", "uuid": "{71c9fc05-02c8-45e1-adfa-13c8ac3399dc}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D"}, "html": {"href": "https://bitbucket.org/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557057:f3a199b9-5784-4964-9644-6ef224bc7dc1/28a4d748-0fd4-4038-bf3d-55a77eb73ede/128"}}, "nickname": "eacousineau", "type": "user", "account_id": "557057:f3a199b9-5784-4964-9644-6ef224bc7dc1"}, "inline": {}, "updated_on": "2020-02-27T18:56:14.175951+00:00", "type": "pullrequest_comment", "id": 137862751}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137859596.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137859596"}}, "parent": {"id": 137846016, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137846016.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137846016"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "Good idea. I had to use `PI/4` for `F2` to get the same representation. b4edf4b", "markup": "markdown", "html": "<p>Good idea. I had to use <code>PI/4</code> for <code>F2</code> to get the same representation. <a href=\"#!/osrf/sdformat/commits/b4edf4b\" rel=\"nofollow\" class=\"ap-connect-link\">b4edf4b</a></p>", "type": "rendered"}, "created_on": "2020-02-27T18:33:43.805899+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2020-02-27T18:33:43.815618+00:00", "type": "pullrequest_comment", "id": 137859596}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 1.570796 0 0</pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 0.785398 0</pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 1.5708 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 0.785398 0</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<?xml version='1.0'?>\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>  <!-- Frame name not transformed -->\r\n        <pose>0 0 0 1.5708 -0 0</pose>  <!-- Pose not transformed -->\r\n      </frame>\r\n      <frame name='F2'> <!-- Frame name not transformed -->\r\n        <pose relative_to='F1'>0 0 0 0 0.785398 0</pose> <!-- Pose not transformed -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose> <!-- Pose transformed but still relative to F1. Resolved pose is incorrect -->\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\n\r\nEdit: Update rotation angles of F1 and F2 and add more comments for clarity.", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "e5a64df5ea26", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/e5a64df5ea26.json"}, "html": {"href": "#!/osrf/sdformat/commits/e5a64df5ea26"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "b4edf4bf7be0", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/b4edf4bf7be0.json"}, "html": {"href": "#!/osrf/sdformat/commits/b4edf4bf7be0"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-02-27T18:32:20.685928+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 3.141592 0 0 </pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 3.141592 0 </pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 3.14159 1e-06 3.14159</pose> <!-- This is the same as 0 0 0 0 3.141592 0 -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='F2'>\r\n        <pose relative_to='F1'>0 0 0 3.14159 1e-06 3.14159</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "e5a64df5ea26", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/e5a64df5ea26.json"}, "html": {"href": "#!/osrf/sdformat/commits/e5a64df5ea26"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "b4edf4bf7be0", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/b4edf4bf7be0.json"}, "html": {"href": "#!/osrf/sdformat/commits/b4edf4bf7be0"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-02-27T17:34:36.264460+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668/comments/137846016.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668/_/diff#comment-137846016"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}, "content": {"raw": "I think if you change the F1 and F2 pose rotation angles from `PI` to `PI/2`, the resulting pose will be more recognizable (referring to the `<!-- This is the same as 0 0 0 0 3.141592 0 -->` comment)", "markup": "markdown", "html": "<p>I think if you change the F1 and F2 pose rotation angles from <code>PI</code> to <code>PI/2</code>, the resulting pose will be more recognizable (referring to the <code>&lt;!-- This is the same as 0 0 0 0 3.141592 0 --&gt;</code> comment)</p>", "type": "rendered"}, "created_on": "2020-02-27T17:04:50.508034+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2020-02-27T17:04:50.514717+00:00", "type": "pullrequest_comment", "id": 137846016}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 3.141592 0 0 </pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 3.141592 0 </pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 3.14159 1e-06 3.14159</pose> <!-- This is the same as 0 0 0 0 3.141592 0 -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='F2'>\r\n        <pose relative_to='F1'>0 0 0 3.14159 1e-06 3.14159</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "e5a64df5ea26", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/e5a64df5ea26.json"}, "html": {"href": "#!/osrf/sdformat/commits/e5a64df5ea26"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "be3c0b47efd8", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/be3c0b47efd8.json"}, "html": {"href": "#!/osrf/sdformat/commits/be3c0b47efd8"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2020-02-27T09:50:36.939280+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 3.141592 0 0 </pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 3.141592 0 </pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 3.14159 1e-06 3.14159</pose> <!-- This is the same as 0 0 0 0 3.141592 0 -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='F2'>\r\n        <pose relative_to='F1'>0 0 0 3.14159 1e-06 3.14159</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "e5a64df5ea26", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/e5a64df5ea26.json"}, "html": {"href": "#!/osrf/sdformat/commits/e5a64df5ea26"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "0c698dda72de", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0c698dda72de.json"}, "html": {"href": "#!/osrf/sdformat/commits/0c698dda72de"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2020-02-27T09:41:53.477874+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 3.141592 0 0 </pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 3.141592 0 </pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 3.14159 1e-06 3.14159</pose> <!-- This is the same as 0 0 0 0 3.141592 0 -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='F2'>\r\n        <pose relative_to='F1'>0 0 0 3.14159 1e-06 3.14159</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "667e9d9cc0d6", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/667e9d9cc0d6.json"}, "html": {"href": "#!/osrf/sdformat/commits/667e9d9cc0d6"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "18a3be660eb6", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/18a3be660eb6.json"}, "html": {"href": "#!/osrf/sdformat/commits/18a3be660eb6"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-02-26T19:58:41.599027+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}, {"update": {"description": "Nested models currently do not support frame semantics because frames from child models are added to the parent model without any transformation. This PR adds the necessary name and pose transformations to add support for models nested using the `<include>` tag. This PR also injects the frame `<model_name>::__model__`,  into the parent model so that the child model's frames, links, and joints are can reference this frame instead of transforming their poses. This is a precursor to full support for composition.\r\n\r\nEg. The following is the original child model\r\n```\r\n<?xml version=\"1.0\" ?>\r\n<sdf version=\"1.7\">\r\n  <model name=\"test_model_with_frames\">\r\n    <frame name=\"F1\">\r\n      <pose>0 0 0 3.141592 0 0 </pose>\r\n    </frame>\r\n    <frame name=\"F2\">\r\n      <pose relative_to=\"F1\">0 0 0 0 3.141592 0 </pose>\r\n    </frame>\r\n    <link name=\"L1\">\r\n      <pose relative_to=\"F1\"/>\r\n    </link>\r\n    <link name=\"L2\">\r\n      <pose relative_to=\"F1\">1 0 0 0 0 0</pose>\r\n    </link>\r\n    <joint name=\"J1\" type=\"revolute\">\r\n      <pose relative_to=\"L1\"/>\r\n      <parent>L1</parent>\r\n      <child>L2</child>\r\n      <axis>\r\n        <xyz expressed_in=\"F2\">0 0 1</xyz>\r\n      </axis>\r\n    </joint>\r\n  </model>\r\n</sdf>\r\n```\r\nand the parent model nesting `test_model_with_frames` as `M1`\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>  \r\n      <include> \r\n        <uri>/path/to/test_model_with_frames/</uri>\r\n        <name>M1</name>\r\n        <pose>10 0 0 0 -0 1.5708</pose>\r\n      </include>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model (with some extra tags removed for clarity) will be\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='M1::__model__' attached_to='M1::L1'>\r\n        <pose relative_to='__model__'>10 0 0 0 -0 1.5708</pose>\r\n      </frame>\r\n      <frame name='M1::F1' attached_to='M1::__model__'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='M1::F2' attached_to='M1::__model__'>\r\n        <pose relative_to='M1::F1'>0 0 0 3.14159 1e-06 3.14159</pose> <!-- This is the same as 0 0 0 0 3.141592 0 -->\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='M1::F1'>0 0 0 0 -0 0</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='M1::F1'>1 0 0 0 -0 0</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='M1::F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```\r\nThe parsed model before this PR:\r\n```\r\n<sdf version='1.7'>\r\n  <world name='default'>\r\n    <model name='ParentModel'>\r\n      <frame name='F1'>\r\n        <pose>0 0 0 3.14159 -0 0</pose>\r\n      </frame>\r\n      <frame name='F2'>\r\n        <pose relative_to='F1'>0 0 0 3.14159 1e-06 3.14159</pose>\r\n      </frame>\r\n      <link name='M1::L1'>\r\n        <pose relative_to='F1'>10 0 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <link name='M1::L2'>\r\n        <pose relative_to='F1'>10 1 0 0 -0 1.5708</pose>\r\n      </link>\r\n      <joint name='M1::J1' type='revolute'>\r\n        <pose relative_to='M1::L1'>0 0 0 0 -0 0</pose>\r\n        <parent>M1::L1</parent>\r\n        <child>M1::L2</child>\r\n        <axis>\r\n          <xyz expressed_in='F2'>0 0 1</xyz>\r\n        </axis>\r\n      </joint>\r\n    </model>\r\n  </world>\r\n</sdf>\r\n```", "title": "Support frame semantics in for models nested with <include>", "destination": {"commit": {"hash": "667e9d9cc0d6", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/667e9d9cc0d6.json"}, "html": {"href": "#!/osrf/sdformat/commits/667e9d9cc0d6"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf9"}}, "reason": "", "source": {"commit": {"hash": "18a3be660eb6", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/18a3be660eb6.json"}, "html": {"href": "#!/osrf/sdformat/commits/18a3be660eb6"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "nested_models_with_frames"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2020-02-26T19:58:41.533003+00:00"}, "pull_request": {"type": "pullrequest", "id": 668, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/668.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/668"}}, "title": "Support frame semantics in for models nested with <include>"}}]}