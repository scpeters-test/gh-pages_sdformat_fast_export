{"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/248/comments/13257357.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/sdformat/diff/carlosmccosta/sdformat:None..None?path=sdf%2F1.6%2Fcamera.sdf"}, "html": {"href": "#!/osrf/sdformat/pull-requests/248/_/diff#comment-13257357"}}, "parent": {"id": 13236944, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/248/comments/13236944.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/248/_/diff#comment-13236944"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 248, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/248.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/248"}}, "title": "Added camera intrinsics (fx, fy, cx, cy, s)."}, "content": {"raw": "In a true pinhole camera, the [<intrinsics>](http://ksimek.github.io/2013/08/13/intrinsic/) are only dependent on the image sensor characteristics, such as:\n\n* sensor parallel pan in relation to the pinhole (cx,cy)\n* sensor distance to the pinhole (fx,fy)\n* sensor axis skew (s)\n\nBut the lens does affect these parameters (mainly fx,fy).\nSo i guess the <intrinsics> could be moved inside the <lens> sdf.\nIn that case, the <distortion> sdf should also be moved inside the <lens> sdf since it does lens distortion.\nAnd since all the parameters inside the current <lens> sdf are used only in [WideAngleCamera.cc](https://bitbucket.org/osrf/gazebo/src/83d77ddaf32bec720720678d42b755db334c1048/gazebo/rendering/WideAngleCamera.cc?at=default&fileviewer=file-view-default), they probably should be grouped in a element inside the lens, such as <wide_lens> or something similar.\n\n\nI have tested the <intrinsics> sdf in conjunction with lens distortion simulation using:\n\n* [the <distortion> sdf](http://gazebosim.org/tutorials?tut=camera_distortion)\n* [image_proc ros package](http://wiki.ros.org/image_proc)\n\nbecause i was trying to simulate a \"normal\" camera lens, and the calibration tools i used were based on [opencv calibration](http://docs.opencv.org/2.4/doc/tutorials/calib3d/camera_calibration/camera_calibration.html), which give the parameters for:\n\n* principal point (cx, cy)\n* focal lenghts (fx, fy)\n* axis skew (s)\n* lens radial distortion (k1,k2,k3)\n* lens tangential distortion (p1,p2)\n\n\nI will do some research to see if the <intrinsics> sdf can be used with the [<lens>](http://gazebosim.org/tutorials?tut=wide_angle_camera&branch=wideanglecamera) sdf ([pr gazebo](https://bitbucket.org/osrf/gazebo/pull-requests/1866/wideangle-camera/diff), [pr sdf](#!/osrf/sdformat/pull-requests/215/camera-lens-description-replaces-213/diff)).", "markup": "markdown", "html": "<p>In a true pinhole camera, the <a data-is-external-link=\"true\" href=\"http://ksimek.github.io/2013/08/13/intrinsic/\" rel=\"nofollow\">&lt;intrinsics&gt;</a> are only dependent on the image sensor characteristics, such as:</p>\n<ul>\n<li>sensor parallel pan in relation to the pinhole (cx,cy)</li>\n<li>sensor distance to the pinhole (fx,fy)</li>\n<li>sensor axis skew (s)</li>\n</ul>\n<p>But the lens does affect these parameters (mainly fx,fy).\nSo i guess the &lt;intrinsics&gt; could be moved inside the &lt;lens&gt; sdf.\nIn that case, the &lt;distortion&gt; sdf should also be moved inside the &lt;lens&gt; sdf since it does lens distortion.\nAnd since all the parameters inside the current &lt;lens&gt; sdf are used only in <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/gazebo/src/83d77ddaf32bec720720678d42b755db334c1048/gazebo/rendering/WideAngleCamera.cc?at=default&amp;fileviewer=file-view-default\" rel=\"nofollow\">WideAngleCamera.cc</a>, they probably should be grouped in a element inside the lens, such as &lt;wide_lens&gt; or something similar.</p>\n<p>I have tested the &lt;intrinsics&gt; sdf in conjunction with lens distortion simulation using:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"http://gazebosim.org/tutorials?tut=camera_distortion\" rel=\"nofollow\">the &lt;distortion&gt; sdf</a></li>\n<li><a data-is-external-link=\"true\" href=\"http://wiki.ros.org/image_proc\" rel=\"nofollow\">image_proc ros package</a></li>\n</ul>\n<p>because i was trying to simulate a \"normal\" camera lens, and the calibration tools i used were based on <a data-is-external-link=\"true\" href=\"http://docs.opencv.org/2.4/doc/tutorials/calib3d/camera_calibration/camera_calibration.html\" rel=\"nofollow\">opencv calibration</a>, which give the parameters for:</p>\n<ul>\n<li>principal point (cx, cy)</li>\n<li>focal lenghts (fx, fy)</li>\n<li>axis skew (s)</li>\n<li>lens radial distortion (k1,k2,k3)</li>\n<li>lens tangential distortion (p1,p2)</li>\n</ul>\n<p>I will do some research to see if the &lt;intrinsics&gt; sdf can be used with the <a data-is-external-link=\"true\" href=\"http://gazebosim.org/tutorials?tut=wide_angle_camera&amp;branch=wideanglecamera\" rel=\"nofollow\">&lt;lens&gt;</a> sdf (<a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/gazebo/pull-requests/1866/wideangle-camera/diff\" rel=\"nofollow\">pr gazebo</a>, <a data-is-external-link=\"true\" href=\"#!/osrf/sdformat/pull-requests/215/camera-lens-description-replaces-213/diff\" rel=\"nofollow\">pr sdf</a>).</p>", "type": "rendered"}, "created_on": "2016-01-07T12:06:52.085218+00:00", "user": {"display_name": "Carlos Miguel Correia da Costa", "uuid": "{8f4eaa49-0391-4770-bde5-edb5358b51a8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B8f4eaa49-0391-4770-bde5-edb5358b51a8%7D"}, "html": {"href": "https://bitbucket.org/%7B8f4eaa49-0391-4770-bde5-edb5358b51a8%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/323d40c3bb4988fad287b6879453b67dd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCC-6.png"}}, "nickname": "carlosmccosta", "type": "user", "account_id": "557058:1675d077-a0e4-4cbc-bcf3-3dcc212ee41c"}, "inline": {"to": null, "from": null, "outdated": false, "path": "sdf/1.6/camera.sdf"}, "updated_on": "2016-01-08T16:54:11.996653+00:00", "type": "pullrequest_comment", "id": 13257357}