{"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/235/comments/11791443.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/235/_/diff#comment-11791443"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 235, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/235.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/235"}}, "title": "collision_blobs for sdf3 branch"}, "content": {"raw": "I just tested building on trusty with `-DUSE_EXTERNAL_URDF=True`, so that it ends up using the system versions of urdfdom 0.2. I'm getting compilation warnings and a test seg-fault:\n\n~~~\n[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc: In function void ReduceCollisionToParent(UrdfLinkPtr, const string&, UrdfCollisionPtr): \n[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc:351:49: warning: boost::shared_ptr<std::vector<boost::shared_ptr<urdf::Collision> > > urdf::Link::getCollisions(const string&) const is deprecated (declared at /usr/include/urdf_model/link.h:264) [-Wdeprecated-declarations] \n[sdformat]    collisions = _parent_link->getCollisions(_name);                                        \n[sdformat]                                                  ^                                         \n[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc: In function void ReduceVisualToParent(UrdfLinkPtr, const string&, UrdfVisualPtr): \n[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc:433:43: warning: boost::shared_ptr<std::vector<boost::shared_ptr<urdf::Visual> > > urdf::Link::getVisuals(const string&) const is deprecated (declared at /usr/include/urdf_model/link.h:255) [-Wdeprecated-declarations] \n[sdformat]    visuals = _parent_link->getVisuals(_name);                                              \n[sdformat]                                            ^                                               \n~~~\n\n~~~\n[ RUN      ] SDFParser.FixedJointReductionCollisionVisualExtensionTest\nMsg [fixed_joint_reduction.cc:150] col: base_link\nMsg [fixed_joint_reduction.cc:150] col: base_link\nMsg [fixed_joint_reduction.cc:150] col: base_link\nMsg [fixed_joint_reduction.cc:150] col: base_link\nMsg [fixed_joint_reduction.cc:168] vis: base_link\nMsg [fixed_joint_reduction.cc:168] vis: base_link\nMsg [fixed_joint_reduction.cc:168] vis: base_link\nMsg [fixed_joint_reduction.cc:168] vis: base_link\nMsg [fixed_joint_reduction.cc:197] col: base_link_collision\nMsg [fixed_joint_reduction.cc:197] col: base_link_lump::child_link_1_collision_1\nMsg [fixed_joint_reduction.cc:197] col: base_link_lump::child_link_2_collision_2\nMsg [fixed_joint_reduction.cc:197] col: base_link_lump::child_link_1a_collision_3\nMsg [fixed_joint_reduction.cc:215] vis: base_link_visual\nMsg [fixed_joint_reduction.cc:215] vis: base_link_lump::child_link_1_visual_1\nMsg [fixed_joint_reduction.cc:215] vis: base_link_lump::child_link_2_visual_2\nMsg [fixed_joint_reduction.cc:215] vis: base_link_lump::child_link_1a_visual_3\nINTEGRATION_fixed_joint_reduction: /usr/include/boost/smart_ptr/shared_ptr.hpp:653: typename boost::detail::sp_member_access<T>::type boost::shared_ptr<T>::operator->() const [with T = sdf::Element; typename boost::detail::sp_member_access<T>::type = sdf::Element*]: Assertion `px != 0' failed.\nAborted (core dumped)\n~~~\n", "markup": "markdown", "html": "<p>I just tested building on trusty with <code>-DUSE_EXTERNAL_URDF=True</code>, so that it ends up using the system versions of urdfdom 0.2. I'm getting compilation warnings and a test seg-fault:</p>\n<div class=\"codehilite\"><pre><span></span>[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc: In function void ReduceCollisionToParent(UrdfLinkPtr, const string&amp;, UrdfCollisionPtr): \n[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc:351:49: warning: boost::shared_ptr&lt;std::vector&lt;boost::shared_ptr&lt;urdf::Collision&gt; &gt; &gt; urdf::Link::getCollisions(const string&amp;) const is deprecated (declared at /usr/include/urdf_model/link.h:264) [-Wdeprecated-declarations] \n[sdformat]    collisions = _parent_link-&gt;getCollisions(_name);                                        \n[sdformat]                                                  ^                                         \n[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc: In function void ReduceVisualToParent(UrdfLinkPtr, const string&amp;, UrdfVisualPtr): \n[sdformat] /home/scpeters/ws/sdformat/src/sdformat/src/parser_urdf.cc:433:43: warning: boost::shared_ptr&lt;std::vector&lt;boost::shared_ptr&lt;urdf::Visual&gt; &gt; &gt; urdf::Link::getVisuals(const string&amp;) const is deprecated (declared at /usr/include/urdf_model/link.h:255) [-Wdeprecated-declarations] \n[sdformat]    visuals = _parent_link-&gt;getVisuals(_name);                                              \n[sdformat]                                            ^                                               \n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span><span class=\"cp\">[</span> <span class=\"nx\">RUN</span>      <span class=\"cp\">]</span> <span class=\"nt\">SDFParser</span><span class=\"p\">.</span><span class=\"nc\">FixedJointReductionCollisionVisualExtensionTest</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">150</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">150</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">150</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">150</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">168</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">168</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">168</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">168</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">197</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link_collision</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">197</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link_lump</span><span class=\"p\">::</span><span class=\"nd\">child_link_1_collision_1</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">197</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link_lump</span><span class=\"p\">::</span><span class=\"nd\">child_link_2_collision_2</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">197</span><span class=\"cp\">]</span> <span class=\"nt\">col</span><span class=\"o\">:</span> <span class=\"nt\">base_link_lump</span><span class=\"p\">::</span><span class=\"nd\">child_link_1a_collision_3</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">215</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link_visual</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">215</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link_lump</span><span class=\"p\">::</span><span class=\"nd\">child_link_1_visual_1</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">215</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link_lump</span><span class=\"p\">::</span><span class=\"nd\">child_link_2_visual_2</span>\n<span class=\"nt\">Msg</span> <span class=\"cp\">[</span><span class=\"nx\">fixed_joint_reduction.cc</span><span class=\"p\">:</span><span class=\"mi\">215</span><span class=\"cp\">]</span> <span class=\"nt\">vis</span><span class=\"o\">:</span> <span class=\"nt\">base_link_lump</span><span class=\"p\">::</span><span class=\"nd\">child_link_1a_visual_3</span>\n<span class=\"nt\">INTEGRATION_fixed_joint_reduction</span><span class=\"o\">:</span> <span class=\"o\">/</span><span class=\"nt\">usr</span><span class=\"o\">/</span><span class=\"nt\">include</span><span class=\"o\">/</span><span class=\"nt\">boost</span><span class=\"o\">/</span><span class=\"nt\">smart_ptr</span><span class=\"o\">/</span><span class=\"nt\">shared_ptr</span><span class=\"p\">.</span><span class=\"nc\">hpp</span><span class=\"p\">:</span><span class=\"nd\">653</span><span class=\"o\">:</span> <span class=\"nt\">typename</span> <span class=\"nt\">boost</span><span class=\"p\">::</span><span class=\"nd\">detail</span><span class=\"p\">::</span><span class=\"nd\">sp_member_access</span><span class=\"o\">&lt;</span><span class=\"nt\">T</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"nd\">type</span> <span class=\"nt\">boost</span><span class=\"p\">::</span><span class=\"nd\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"nt\">T</span><span class=\"o\">&gt;</span><span class=\"p\">::</span><span class=\"nd\">operator-</span><span class=\"o\">&gt;()</span> <span class=\"nt\">const</span> <span class=\"cp\">[</span><span class=\"k\">with</span> <span class=\"n\">T</span><span class=\"o\"> =</span> <span class=\"nx\">sdf</span><span class=\"nl\">::Element</span><span class=\"p\">;</span> <span class=\"nx\">typename</span> <span class=\"nx\">boost</span><span class=\"nl\">::detail::sp_member_access</span><span class=\"o\">&lt;</span><span class=\"nx\">T</span><span class=\"o\">&gt;</span><span class=\"nl\">::type</span> <span class=\"o\">=</span> <span class=\"nx\">sdf</span><span class=\"nl\">::Element</span><span class=\"o\">*</span><span class=\"cp\">]</span><span class=\"o\">:</span> <span class=\"nt\">Assertion</span> <span class=\"err\">`</span><span class=\"nt\">px</span> <span class=\"o\">!=</span> <span class=\"nt\">0</span><span class=\"err\">&#39;</span> <span class=\"nt\">failed</span><span class=\"o\">.</span>\n<span class=\"nt\">Aborted</span> <span class=\"o\">(</span><span class=\"nt\">core</span> <span class=\"nt\">dumped</span><span class=\"o\">)</span>\n</pre></div>", "type": "rendered"}, "created_on": "2015-11-13T17:59:32.941920+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2015-11-13T17:59:32.944460+00:00", "type": "pullrequest_comment", "id": 11791443}