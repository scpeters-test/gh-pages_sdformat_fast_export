{"pagelen": 50, "values": [{"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "02651be971ed", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/02651be971ed.json"}, "html": {"href": "#!/osrf/sdformat/commits/02651be971ed"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "82d9c2926573", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/82d9c2926573.json"}, "html": {"href": "#!/osrf/sdformat/commits/82d9c2926573"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "MERGED", "author": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "date": "2017-09-06T13:24:10.357539+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/44348796.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-44348796"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "content": {"raw": "Thanks for the reviews.  I'm going to merge this now.", "markup": "markdown", "html": "<p>Thanks for the reviews.  I'm going to merge this now.</p>", "type": "rendered"}, "created_on": "2017-09-06T13:13:04.471679+00:00", "user": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "updated_on": "2017-09-06T13:13:04.474274+00:00", "type": "pullrequest_comment", "id": 44348796}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "02651be971ed", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/02651be971ed.json"}, "html": {"href": "#!/osrf/sdformat/commits/02651be971ed"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "82d9c2926573", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/82d9c2926573.json"}, "html": {"href": "#!/osrf/sdformat/commits/82d9c2926573"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2017-09-05T22:07:22.167962+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"approval": {"date": "2017-09-05T22:04:06.583309+00:00", "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"approval": {"date": "2017-08-21T18:20:18.508704+00:00", "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "06eff281aba7", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/06eff281aba7.json"}, "html": {"href": "#!/osrf/sdformat/commits/06eff281aba7"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "e0467a48f33d", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/e0467a48f33d.json"}, "html": {"href": "#!/osrf/sdformat/commits/e0467a48f33d"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2017-08-21T17:52:25.933124+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/43134447.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-43134447"}}, "parent": {"id": 40022129, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/40022129.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-40022129"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "content": {"raw": "Oh, I see that I never answered your second question about duplicate convert files.  In theory, there really shouldn't be duplicates; each subdirectory should have a single file, converting from the previous version to this one.  In the main SDF conversion files, this is the case.  Since users are allowed to install their own files, though, there is no guarantee that this is the case.  With the std::set, you are right, it is going to (silently) filter out duplicates.  However, that can lead to surprising behavior, because which one it filters out will depend on the directory order (which is not guaranteed to be stable).  Probably the correct thing here is to add a warning if we see duplicates, and fail the conversion.  That all being said, I think the way we go about this whole conversion needs another rethink, because it has some issues right now (see my top-level comment).", "markup": "markdown", "html": "<p>Oh, I see that I never answered your second question about duplicate convert files.  In theory, there really shouldn't be duplicates; each subdirectory should have a single file, converting from the previous version to this one.  In the main SDF conversion files, this is the case.  Since users are allowed to install their own files, though, there is no guarantee that this is the case.  With the std::set, you are right, it is going to (silently) filter out duplicates.  However, that can lead to surprising behavior, because which one it filters out will depend on the directory order (which is not guaranteed to be stable).  Probably the correct thing here is to add a warning if we see duplicates, and fail the conversion.  That all being said, I think the way we go about this whole conversion needs another rethink, because it has some issues right now (see my top-level comment).</p>", "type": "rendered"}, "created_on": "2017-08-18T19:04:46.659524+00:00", "user": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "inline": {}, "updated_on": "2017-08-18T19:04:46.662242+00:00", "type": "pullrequest_comment", "id": 43134447}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "0b0cda9e7f7f", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0b0cda9e7f7f.json"}, "html": {"href": "#!/osrf/sdformat/commits/0b0cda9e7f7f"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "a07f7536499a", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/a07f7536499a.json"}, "html": {"href": "#!/osrf/sdformat/commits/a07f7536499a"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "OPEN", "author": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "date": "2017-08-18T17:58:49.701979+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "bac3dfb42cc7", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/bac3dfb42cc7.json"}, "html": {"href": "#!/osrf/sdformat/commits/bac3dfb42cc7"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "7b8736c191d6", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/7b8736c191d6.json"}, "html": {"href": "#!/osrf/sdformat/commits/7b8736c191d6"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "OPEN", "author": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "date": "2017-07-14T17:13:50.025382+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/40412016.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-40412016"}}, "parent": {"id": 40022129, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/40022129.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-40022129"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "content": {"raw": "Yeah, that would be another way to fix the problem.  The benefit to it is that code like that makes it really clear that we want things in a particular order.  The downside is that it adds more code, that we get more-or-less for \"free\" by using a set.  My preference would be to restore this functionality like it is (using a set), and then improve it later by doing what you say (once we have good unit tests for the problem).  Thoughts?", "markup": "markdown", "html": "<p>Yeah, that would be another way to fix the problem.  The benefit to it is that code like that makes it really clear that we want things in a particular order.  The downside is that it adds more code, that we get more-or-less for \"free\" by using a set.  My preference would be to restore this functionality like it is (using a set), and then improve it later by doing what you say (once we have good unit tests for the problem).  Thoughts?</p>", "type": "rendered"}, "created_on": "2017-07-10T14:12:15.383350+00:00", "user": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "inline": {}, "updated_on": "2017-07-10T14:12:15.386240+00:00", "type": "pullrequest_comment", "id": 40412016}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/40022129.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-40022129"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "content": {"raw": "How about `std::list` put into the right order using `std::sort` with a compare function that uses `std::lexicographical_compare`? Is another use of the set to filter duplicate convert files?", "markup": "markdown", "html": "<p>How about <code>std::list</code> put into the right order using <code>std::sort</code> with a compare function that uses <code>std::lexicographical_compare</code>? Is another use of the set to filter duplicate convert files?</p>", "type": "rendered"}, "created_on": "2017-07-03T23:58:44.705339+00:00", "user": {"display_name": "Shane Loretz", "uuid": "{656e3311-aad9-45a1-aaf7-b0ee0e84b287}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D"}, "html": {"href": "https://bitbucket.org/%7B656e3311-aad9-45a1-aaf7-b0ee0e84b287%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:684383ab-ac95-4859-a350-4a6f41a94a22/c7a1ebf5-cade-4115-9f26-9d3facb776db/128"}}, "nickname": "Shane Loretz", "type": "user", "account_id": "557058:684383ab-ac95-4859-a350-4a6f41a94a22"}, "inline": {}, "updated_on": "2017-07-03T23:58:44.708253+00:00", "type": "pullrequest_comment", "id": 40022129}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/39818354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-39818354"}}, "parent": {"id": 39770106, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/39770106.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-39770106"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "content": {"raw": "There is no way you should have remembered; I never stated it, which I should have.\n\nThe basic problem shows up if you want to convert from (say) SDF 1.2 to SDF 1.6.  In that case, what we really want to do is to migrate from 1.2 -> 1.3, 1.3 -> 1.4, 1.4 -> 1.5, and 1.5 -> 1.6, in that order.  However, there is no guarantee that the directory iterator returns the directory names in lexicographical order, so when using a list to store the directories, they just get put into the list in whatever order the directory iterator happens to return them.  Using a set, on the other hand inserts them in ascending order, which is exactly what we want (I believe set is implemented as a red-black tree).  So that's the bug.\n\nThe reason you don't see the problem in testing is because of another, complex bug in our testing environment that this patch does not address (but which is on my radar, and we should eventually address).  Our testing environment sets up the SDF_PATH environment variable something like: SDF_PATH=sdf/1.2:sdf/1.3:sdf/1.4:sdf/1.5:sdf/1.6 .  When Converter::Convert() goes to look up a conversion file, it looks for a filename that looks like <frommajor>_<fromminor>.version.  Thus, when trying to convert *from* 1.2 to 1.6, it looks up 1_2.version.  Given the above SDF_PATH, it dutifully finds that file, but only the version that goes from 1.2 -> 1.3.  Because of the rest of the logic in Convert(), it thinks this is good enough, and just does that conversion.  The rest are skipped.  The reason this is a complex problem to fix is that *other* tests actually depend on SDF_PATH being what it is, and further, the whole way that sdf::findFile() goes about finding things seems odd.  There are several ways to tell sdf::findFile() that you want to use custom sdf files, but since sdf::findFile() is used to find individual files and directories full of files, it doesn't seem like there is a good, intuitive way to indicate the root of a tree to it.\n\nWhew, this is getting long, so just a couple more things.\n\n1.  I think we should merge this patch to fix the bug that is there.  You are right that the tests don't quite prevent it's recurrence in the future, but at the very least I know for sure what is there is wrong.\n1.  We can augment the tests in Converter_TEST.cc to actually check that the converted file they get back has the version they expect.  This will currently fail, though.\n1.  We should figure out how to make these tests pass correctly, which I believe means clarifying what sdf::findFile() is really supposed to be used for, and how it is implemented.\n\nThoughts?", "markup": "markdown", "html": "<p>There is no way you should have remembered; I never stated it, which I should have.</p>\n<p>The basic problem shows up if you want to convert from (say) SDF 1.2 to SDF 1.6.  In that case, what we really want to do is to migrate from 1.2 -&gt; 1.3, 1.3 -&gt; 1.4, 1.4 -&gt; 1.5, and 1.5 -&gt; 1.6, in that order.  However, there is no guarantee that the directory iterator returns the directory names in lexicographical order, so when using a list to store the directories, they just get put into the list in whatever order the directory iterator happens to return them.  Using a set, on the other hand inserts them in ascending order, which is exactly what we want (I believe set is implemented as a red-black tree).  So that's the bug.</p>\n<p>The reason you don't see the problem in testing is because of another, complex bug in our testing environment that this patch does not address (but which is on my radar, and we should eventually address).  Our testing environment sets up the SDF_PATH environment variable something like: SDF_PATH=sdf/1.2:sdf/1.3:sdf/1.4:sdf/1.5:sdf/1.6 .  When Converter::Convert() goes to look up a conversion file, it looks for a filename that looks like &lt;frommajor&gt;_&lt;fromminor&gt;.version.  Thus, when trying to convert <em>from</em> 1.2 to 1.6, it looks up 1_2.version.  Given the above SDF_PATH, it dutifully finds that file, but only the version that goes from 1.2 -&gt; 1.3.  Because of the rest of the logic in Convert(), it thinks this is good enough, and just does that conversion.  The rest are skipped.  The reason this is a complex problem to fix is that <em>other</em> tests actually depend on SDF_PATH being what it is, and further, the whole way that sdf::findFile() goes about finding things seems odd.  There are several ways to tell sdf::findFile() that you want to use custom sdf files, but since sdf::findFile() is used to find individual files and directories full of files, it doesn't seem like there is a good, intuitive way to indicate the root of a tree to it.</p>\n<p>Whew, this is getting long, so just a couple more things.</p>\n<ol>\n<li>I think we should merge this patch to fix the bug that is there.  You are right that the tests don't quite prevent it's recurrence in the future, but at the very least I know for sure what is there is wrong.</li>\n<li>We can augment the tests in Converter_TEST.cc to actually check that the converted file they get back has the version they expect.  This will currently fail, though.</li>\n<li>We should figure out how to make these tests pass correctly, which I believe means clarifying what sdf::findFile() is really supposed to be used for, and how it is implemented.</li>\n</ol>\n<p>Thoughts?</p>", "type": "rendered"}, "created_on": "2017-06-29T13:12:20.507073+00:00", "user": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "updated_on": "2017-06-29T13:12:20.509882+00:00", "type": "pullrequest_comment", "id": 39818354}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354/comments/39770106.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354/_/diff#comment-39770106"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}, "content": {"raw": "Sorry for not remembering, but what is the Converter bug that this fixes? I tried compiling just the changes to Converter_TEST.cc, and the test still pass on my mac without the changes to Converter.cc. So I'm not sure the new tests fully demonstrate the bug.", "markup": "markdown", "html": "<p>Sorry for not remembering, but what is the Converter bug that this fixes? I tried compiling just the changes to Converter_TEST.cc, and the test still pass on my mac without the changes to Converter.cc. So I'm not sure the new tests fully demonstrate the bug.</p>", "type": "rendered"}, "created_on": "2017-06-28T22:33:01.365774+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2017-06-28T22:33:01.368391+00:00", "type": "pullrequest_comment", "id": 39770106}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "0cab91fe6b2b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0cab91fe6b2b.json"}, "html": {"href": "#!/osrf/sdformat/commits/0cab91fe6b2b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "d1ab231f854b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/d1ab231f854b.json"}, "html": {"href": "#!/osrf/sdformat/commits/d1ab231f854b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "OPEN", "author": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "date": "2017-06-28T22:11:26.337280+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "0cab91fe6b2b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0cab91fe6b2b.json"}, "html": {"href": "#!/osrf/sdformat/commits/0cab91fe6b2b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "70bb01ad9655", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/70bb01ad9655.json"}, "html": {"href": "#!/osrf/sdformat/commits/70bb01ad9655"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "OPEN", "author": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "date": "2017-06-28T21:42:14.309655+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}, {"update": {"description": "* Start branch converter-fix\r\n\r\n* Fix a nasty Converter bug I introduced earlier.\r\n\r\n    Along with this add tests to try and test the situation\r\n    that caused the bug.  Also do some indentation cleanup\r\n    and various other small fixes involved with Converter.", "title": "Converter fix", "destination": {"commit": {"hash": "0cab91fe6b2b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0cab91fe6b2b.json"}, "html": {"href": "#!/osrf/sdformat/commits/0cab91fe6b2b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "default"}}, "reason": "", "source": {"commit": {"hash": "70bb01ad9655", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/70bb01ad9655.json"}, "html": {"href": "#!/osrf/sdformat/commits/70bb01ad9655"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "converter-fix"}}, "state": "OPEN", "author": {"display_name": "clalancette", "uuid": "{02b311e1-297d-4232-89c4-5485d0a02911}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D"}, "html": {"href": "https://bitbucket.org/%7B02b311e1-297d-4232-89c4-5485d0a02911%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f/048a0933-60ac-4910-a6a5-ed058bdea8eb/128"}}, "nickname": "clalancette", "type": "user", "account_id": "557058:ad6ed80b-ec66-45cb-9504-b1094a415b7f"}, "date": "2017-06-28T21:42:14.231335+00:00"}, "pull_request": {"type": "pullrequest", "id": 354, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/354.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/354"}}, "title": "Converter fix"}}]}