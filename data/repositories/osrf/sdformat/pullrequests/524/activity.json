{"pagelen": 50, "values": [{"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "Rule of five for various DOM classes", "destination": {"commit": {"hash": "234d73a893ad", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/234d73a893ad.json"}, "html": {"href": "#!/osrf/sdformat/commits/234d73a893ad"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "c1bc643a950b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/c1bc643a950b.json"}, "html": {"href": "#!/osrf/sdformat/commits/c1bc643a950b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "MERGED", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-04-26T00:07:52.290880+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"approval": {"date": "2019-04-26T00:07:45.738330+00:00", "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100069277.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100069277"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "API/ABI job\n\n* [![Build Status](https://build.osrfoundation.org/buildStatus/icon?job=sdformat-abichecker-any_to_any-ubuntu_auto-amd64&build=106)](https://build.osrfoundation.org/job/sdformat-abichecker-any_to_any-ubuntu_auto-amd64/106/) https://build.osrfoundation.org/job/sdformat-abichecker-any_to_any-ubuntu_auto-amd64/106/", "markup": "markdown", "html": "<p>API/ABI job</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"https://build.osrfoundation.org/job/sdformat-abichecker-any_to_any-ubuntu_auto-amd64/106/\" rel=\"nofollow\"><img alt=\"Build Status\" src=\"https://build.osrfoundation.org/buildStatus/icon?job=sdformat-abichecker-any_to_any-ubuntu_auto-amd64&amp;build=106\" /></a> <a href=\"https://build.osrfoundation.org/job/sdformat-abichecker-any_to_any-ubuntu_auto-amd64/106/\" rel=\"nofollow\" class=\"ap-connect-link\">https://build.osrfoundation.org/job/sdformat-abichecker-any_to_any-ubuntu_auto-amd64/106/</a></li>\n</ul>", "type": "rendered"}, "created_on": "2019-04-26T00:02:23.116915+00:00", "user": {"display_name": "Steve Peters", "uuid": "{2ccfed09-18b8-4921-8d58-15ef01092802}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D"}, "html": {"href": "https://bitbucket.org/%7B2ccfed09-18b8-4921-8d58-15ef01092802%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/1fb4816dad9e68337d3096f750951f6cd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsSP-1.png"}}, "nickname": "Steven Peters", "type": "user", "account_id": "557058:5de38267-b118-494c-aa76-4fab35448816"}, "updated_on": "2019-04-26T00:02:23.123544+00:00", "type": "pullrequest_comment", "id": 100069277}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100066614.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100066614"}}, "parent": {"id": 100043209, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043209.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043209"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Added in d89a9e3 and c1bc643. Ready to approve once the CI / coverage is back.", "markup": "markdown", "html": "<p>Added in <a href=\"#!/osrf/sdformat/commits/d89a9e3\" rel=\"nofollow\" class=\"ap-connect-link\">d89a9e3</a> and <a href=\"#!/osrf/sdformat/commits/c1bc643\" rel=\"nofollow\" class=\"ap-connect-link\">c1bc643</a>. Ready to approve once the CI / coverage is back.</p>", "type": "rendered"}, "created_on": "2019-04-25T23:03:41.121596+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-04-25T23:03:41.132341+00:00", "type": "pullrequest_comment", "id": 100066614}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "Rule of five for various DOM classes", "destination": {"commit": {"hash": "234d73a893ad", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/234d73a893ad.json"}, "html": {"href": "#!/osrf/sdformat/commits/234d73a893ad"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "c1bc643a950b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/c1bc643a950b.json"}, "html": {"href": "#!/osrf/sdformat/commits/c1bc643a950b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-04-25T23:02:49.773857+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043925.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043925"}}, "parent": {"id": 100043545, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043545.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043545"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Thanks!", "markup": "markdown", "html": "<p>Thanks!</p>", "type": "rendered"}, "created_on": "2019-04-25T18:41:21.924784+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2019-04-25T18:41:21.938764+00:00", "type": "pullrequest_comment", "id": 100043925}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043633.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043633"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "LGTM, it would just be good to add copy/move tests for the `Pbr` class.", "markup": "markdown", "html": "<p>LGTM, it would just be good to add copy/move tests for the <code>Pbr</code> class.</p>", "type": "rendered"}, "created_on": "2019-04-25T18:38:22.612846+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "updated_on": "2019-04-25T18:38:22.625343+00:00", "type": "pullrequest_comment", "id": 100043633}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043545.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043545"}}, "parent": {"id": 100043217, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043217.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043217"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "204b71b", "markup": "markdown", "html": "<p><a href=\"#!/osrf/sdformat/commits/204b71b\" rel=\"nofollow\" class=\"ap-connect-link\">204b71b</a></p>", "type": "rendered"}, "created_on": "2019-04-25T18:37:34.935828+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-04-25T18:37:34.949928+00:00", "type": "pullrequest_comment", "id": 100043545}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "Rule of five for various DOM classes", "destination": {"commit": {"hash": "234d73a893ad", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/234d73a893ad.json"}, "html": {"href": "#!/osrf/sdformat/commits/234d73a893ad"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "204b71bb0af7", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/204b71bb0af7.json"}, "html": {"href": "#!/osrf/sdformat/commits/204b71bb0af7"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "date": "2019-04-25T18:37:13.840944+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043217.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043217"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "I think the assignment must be done after creation for the assignment operator to be used. The [coverage report](https://codecov.io/bb/osrf/sdformat/src/51cf0930b6bc003d330c59fabe8818ec189a290a/src/Material.cc#L126) gave it away.", "markup": "markdown", "html": "<p>I think the assignment must be done after creation for the assignment operator to be used. The <a data-is-external-link=\"true\" href=\"https://codecov.io/bb/osrf/sdformat/src/51cf0930b6bc003d330c59fabe8818ec189a290a/src/Material.cc#L126\" rel=\"nofollow\">coverage report</a> gave it away.</p>", "type": "rendered"}, "created_on": "2019-04-25T18:34:34.409188+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-04-25T18:34:34.420810+00:00", "type": "pullrequest_comment", "id": 100043217}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100043209.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100043209"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "We're [missing](https://codecov.io/bb/osrf/sdformat/src/51cf0930b6bc003d330c59fabe8818ec189a290a/src/Pbr.cc#L363) copy/move tests for the `sdf::Pbr` class itself (`PbrWorkFlow` already has them)", "markup": "markdown", "html": "<p>We're <a data-is-external-link=\"true\" href=\"https://codecov.io/bb/osrf/sdformat/src/51cf0930b6bc003d330c59fabe8818ec189a290a/src/Pbr.cc#L363\" rel=\"nofollow\">missing</a> copy/move tests for the <code>sdf::Pbr</code> class itself (<code>PbrWorkFlow</code> already has them)</p>", "type": "rendered"}, "created_on": "2019-04-25T18:34:28.068225+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-04-25T18:34:28.078133+00:00", "type": "pullrequest_comment", "id": 100043209}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"approval": {"date": "2019-04-25T15:54:57.841198+00:00", "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/100012718.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-100012718"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "This looks okay. I'm going to create a quick memory test to check for any potential leaks.", "markup": "markdown", "html": "<p>This looks okay. I'm going to create a quick memory test to check for any potential leaks.</p>", "type": "rendered"}, "created_on": "2019-04-25T14:51:33.031741+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "updated_on": "2019-04-25T14:51:33.042528+00:00", "type": "pullrequest_comment", "id": 100012718}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "Rule of five for various DOM classes", "destination": {"commit": {"hash": "234d73a893ad", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/234d73a893ad.json"}, "html": {"href": "#!/osrf/sdformat/commits/234d73a893ad"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "93cb24851d55", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/93cb24851d55.json"}, "html": {"href": "#!/osrf/sdformat/commits/93cb24851d55"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "date": "2019-04-25T14:36:35.741338+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99911482.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99911482"}}, "parent": {"id": 99909433, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99909433.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99909433"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Never mind. It's running now.", "markup": "markdown", "html": "<p>Never mind. It's running now.</p>", "type": "rendered"}, "created_on": "2019-04-24T23:54:16.459644+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2019-04-24T23:54:16.469052+00:00", "type": "pullrequest_comment", "id": 99911482}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "Rule of five for various DOM classes", "destination": {"commit": {"hash": "0704cc62db40", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0704cc62db40.json"}, "html": {"href": "#!/osrf/sdformat/commits/0704cc62db40"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "51cf0930b6bc", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/51cf0930b6bc.json"}, "html": {"href": "#!/osrf/sdformat/commits/51cf0930b6bc"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2019-04-24T23:52:54.928220+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "[WIP] Rule of five for various DOM classes", "destination": {"commit": {"hash": "0704cc62db40", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0704cc62db40.json"}, "html": {"href": "#!/osrf/sdformat/commits/0704cc62db40"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "51cf0930b6bc", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/51cf0930b6bc.json"}, "html": {"href": "#!/osrf/sdformat/commits/51cf0930b6bc"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2019-04-24T23:52:26.569272+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99909433.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99909433"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Any one know why pipelines aren't running for this PR?", "markup": "markdown", "html": "<p>Any one know why pipelines aren't running for this PR?</p>", "type": "rendered"}, "created_on": "2019-04-24T22:58:31.207173+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2019-04-24T22:58:31.215828+00:00", "type": "pullrequest_comment", "id": 99909433}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99909295.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99909295"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Sorry for the large PR. I didn't want to leave out any :slight_smile: \n\nA notable change I made in 6f9ce67 is for `*Private` classes that hold `unique_ptr`s, such as `VisualPrivate`, I opted for creating a copy constructor and using a placement new in `Visual &Visual::operator=(const Visual &_visual)` [like so.](#!/osrf/sdformat/pull-requests/524/wip-rule-of-five-for-various-dom-classes/diff#Lsrc/Visual.ccT93) I haven't used placement new before so I would appreciate if someone could check me.", "markup": "markdown", "html": "<p>Sorry for the large PR. I didn't want to leave out any <img class=\"emoji\" src=\"data/pf-emoji-service--cdn.us-east-1.prod.public.atl-paas.net/standard/551c9814-1d37-4573-819d-afab3afeaf32/48x48/1f642.png\" alt=\"\ud83d\ude42\" title=\":slight_smile:\" data-emoji-short-name=\":slight_smile:\" /> </p>\n<p>A notable change I made in <a href=\"#!/osrf/sdformat/commits/6f9ce67\" rel=\"nofollow\" class=\"ap-connect-link\">6f9ce67</a> is for <code>*Private</code> classes that hold <code>unique_ptr</code>s, such as <code>VisualPrivate</code>, I opted for creating a copy constructor and using a placement new in <code>Visual &amp;Visual::operator=(const Visual &amp;_visual)</code> <a data-is-external-link=\"true\" href=\"#!/osrf/sdformat/pull-requests/524/wip-rule-of-five-for-various-dom-classes/diff#Lsrc/Visual.ccT93\" rel=\"nofollow\">like so.</a> I haven't used placement new before so I would appreciate if someone could check me.</p>", "type": "rendered"}, "created_on": "2019-04-24T22:54:30.664867+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "updated_on": "2019-04-24T22:54:30.672654+00:00", "type": "pullrequest_comment", "id": 99909295}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99909011.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99909011"}}, "parent": {"id": 99906359, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99906359.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99906359"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Turns out, `math::Pose3d` does not have a move constructor that is `noexcept(true)`. I removed this move constructor anyway because we never have to move these private class. 6f9ce67", "markup": "markdown", "html": "<p>Turns out, <code>math::Pose3d</code> does not have a move constructor that is <code>noexcept(true)</code>. I removed this move constructor anyway because we never have to move these private class. <a href=\"#!/osrf/sdformat/commits/6f9ce67\" rel=\"nofollow\" class=\"ap-connect-link\">6f9ce67</a></p>", "type": "rendered"}, "created_on": "2019-04-24T22:46:38.452097+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2019-04-24T22:46:38.461153+00:00", "type": "pullrequest_comment", "id": 99909011}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "[WIP] Rule of five for various DOM classes", "destination": {"commit": {"hash": "0704cc62db40", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0704cc62db40.json"}, "html": {"href": "#!/osrf/sdformat/commits/0704cc62db40"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "6f9ce67d951c", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/6f9ce67d951c.json"}, "html": {"href": "#!/osrf/sdformat/commits/6f9ce67d951c"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2019-04-24T22:30:49.677757+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99906359.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99906359"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "clang is unhappy:\n\n~~~\n/Users/jenkins/workspace/sdformat-ci-pr_any-homebrew-amd64/sdformat/src/Joint.cc:47:20: error: exception specification of explicitly defaulted move constructor does not match the calculated one\n  public: explicit JointPrivate(JointPrivate &&_jointPrivate)\n                   ^\n~~~", "markup": "markdown", "html": "<p>clang is unhappy:</p>\n<div class=\"codehilite\"><pre><span></span>/Users/jenkins/workspace/sdformat-ci-pr_any-homebrew-amd64/sdformat/src/Joint.cc:47:20: error: exception specification of explicitly defaulted move constructor does not match the calculated one\n  public: explicit JointPrivate(JointPrivate &amp;&amp;_jointPrivate)\n                   ^\n</pre></div>", "type": "rendered"}, "created_on": "2019-04-24T22:00:32.961584+00:00", "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "inline": {}, "updated_on": "2019-04-24T22:00:32.971192+00:00", "type": "pullrequest_comment", "id": 99906359}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "[WIP] Rule of five for various DOM classes", "destination": {"commit": {"hash": "0704cc62db40", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/0704cc62db40.json"}, "html": {"href": "#!/osrf/sdformat/commits/0704cc62db40"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "ed96e1c29b2e", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/ed96e1c29b2e.json"}, "html": {"href": "#!/osrf/sdformat/commits/ed96e1c29b2e"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2019-04-24T21:41:28.946231+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99732922.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99732922"}}, "parent": {"id": 99731378, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99731378.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99731378"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Okay. I follow your logic, and it all sounds good to me. Thanks.", "markup": "markdown", "html": "<p>Okay. I follow your logic, and it all sounds good to me. Thanks.</p>", "type": "rendered"}, "created_on": "2019-04-23T21:37:51.354937+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-04-23T21:37:51.373037+00:00", "type": "pullrequest_comment", "id": 99732922}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99731378.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99731378"}}, "parent": {"id": 99728309, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99728309.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99728309"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "> Good point. I think people will argue that an object shouldn't be used after it has been moved.\n\nI agree. Calling any other member function would be invalid. But I think copy assigning should still be valid. This is what happens in `std::swap` if the class doesn't have a move assignment operator but does have a move constructor. \n\n> Also, you want to follow this approach then you should probably create new dataPtr for the moved object in the move operator and constructor. Otherwise you'll need this if statement in each accessor/setter.\n\nThis is true. I'm inclined to say moved from objects don't have a valid state and calling any member function except assignment is undefined. In my mind, this seems to be the simplest approach. There is some discussion [here](https://stackoverflow.com/questions/12095048/what-constitutes-a-valid-state-for-a-moved-from-object-in-c11) about how moved from objects are supposed to behave. What you suggest is (allocating a new `dataPtr`) is valid, but it would incur the cost of heap allocation, which is expensive while moving should theoretically be cheap. \n", "markup": "markdown", "html": "<blockquote>\n<p>Good point. I think people will argue that an object shouldn't be used after it has been moved.</p>\n</blockquote>\n<p>I agree. Calling any other member function would be invalid. But I think copy assigning should still be valid. This is what happens in <code>std::swap</code> if the class doesn't have a move assignment operator but does have a move constructor. </p>\n<blockquote>\n<p>Also, you want to follow this approach then you should probably create new dataPtr for the moved object in the move operator and constructor. Otherwise you'll need this if statement in each accessor/setter.</p>\n</blockquote>\n<p>This is true. I'm inclined to say moved from objects don't have a valid state and calling any member function except assignment is undefined. In my mind, this seems to be the simplest approach. There is some discussion <a data-is-external-link=\"true\" href=\"https://stackoverflow.com/questions/12095048/what-constitutes-a-valid-state-for-a-moved-from-object-in-c11\" rel=\"nofollow\">here</a> about how moved from objects are supposed to behave. What you suggest is (allocating a new <code>dataPtr</code>) is valid, but it would incur the cost of heap allocation, which is expensive while moving should theoretically be cheap. </p>", "type": "rendered"}, "created_on": "2019-04-23T21:19:53.060390+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2019-04-23T21:19:53.072869+00:00", "type": "pullrequest_comment", "id": 99731378}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99728309.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99728309"}}, "parent": {"id": 99727515, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99727515.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99727515"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "Good point. I think people will argue that an object shouldn't be used after it has been moved.\n\nAlso, you want to follow this approach then you should probably create new `dataPtr` for the moved object in the move operator and constructor. Otherwise you'll need this if statement in each accessor/setter.", "markup": "markdown", "html": "<p>Good point. I think people will argue that an object shouldn't be used after it has been moved.</p>\n<p>Also, you want to follow this approach then you should probably create new <code>dataPtr</code> for the moved object in the move operator and constructor. Otherwise you'll need this if statement in each accessor/setter.</p>", "type": "rendered"}, "created_on": "2019-04-23T20:49:22.253351+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-04-23T20:49:22.264224+00:00", "type": "pullrequest_comment", "id": 99728309}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99727515.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99727515"}}, "parent": {"id": 99726763, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99726763.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99726763"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "The only exception is that `dataPtr` becomes null when the object is moved from. Eg.\n\n```c++\nsdf::Atmosphere a;\nsdf::Atmosphere b;\n\nsdf::Atmosphere c = std::move(a); // a.dataPtr becomes nullptr\na = b; // Crashes until this PR\n```", "markup": "markdown", "html": "<p>The only exception is that <code>dataPtr</code> becomes null when the object is moved from. Eg.</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">Atmosphere</span> <span class=\"n\">a</span><span class=\"p\">;</span>\n<span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">Atmosphere</span> <span class=\"n\">b</span><span class=\"p\">;</span>\n\n<span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">Atmosphere</span> <span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">move</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">);</span> <span class=\"c1\">// a.dataPtr becomes nullptr</span>\n<span class=\"n\">a</span> <span class=\"o\">=</span> <span class=\"n\">b</span><span class=\"p\">;</span> <span class=\"c1\">// Crashes until this PR</span>\n</pre></div>", "type": "rendered"}, "created_on": "2019-04-23T20:42:29.744503+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2019-04-23T20:42:29.758533+00:00", "type": "pullrequest_comment", "id": 99727515}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99726763.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99726763"}}, "parent": {"id": 99724171, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99724171.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99724171"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "I think `dataPtr` is never `null`, or should never be `null`. All the constructors create the `dataPtr`. \n\n\nMy statement about deleting the dataPtr first is incorrect. The part about skipping the `if` should still hold. ", "markup": "markdown", "html": "<p>I think <code>dataPtr</code> is never <code>null</code>, or should never be <code>null</code>. All the constructors create the <code>dataPtr</code>. </p>\n<p>My statement about deleting the dataPtr first is incorrect. The part about skipping the <code>if</code> should still hold. </p>", "type": "rendered"}, "created_on": "2019-04-23T20:34:57.514222+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-04-23T20:34:57.524705+00:00", "type": "pullrequest_comment", "id": 99726763}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99724171.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99724171"}}, "parent": {"id": 99717909, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99717909.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99717909"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "My intention was to allocate only if `dataPtr` is a `nullptr`. If it's not `nullptr`, we can avoid an extra allocation and use the memory that is already allocated. Did I miss something?", "markup": "markdown", "html": "<p>My intention was to allocate only if <code>dataPtr</code> is a <code>nullptr</code>. If it's not <code>nullptr</code>, we can avoid an extra allocation and use the memory that is already allocated. Did I miss something?</p>", "type": "rendered"}, "created_on": "2019-04-23T20:10:45.309868+00:00", "user": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "inline": {}, "updated_on": "2019-04-23T20:10:45.318989+00:00", "type": "pullrequest_comment", "id": 99724171}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"comment": {"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524/comments/99717909.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524/_/diff#comment-99717909"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}, "content": {"raw": "I think you can avoid this `if` statement. \n\nIf not, then you'll need to `delete` the dataPtr first since it's not a unique_ptr. I think there are other occurrences of this pattern.", "markup": "markdown", "html": "<p>I think you can avoid this <code>if</code> statement. </p>\n<p>If not, then you'll need to <code>delete</code> the dataPtr first since it's not a unique_ptr. I think there are other occurrences of this pattern.</p>", "type": "rendered"}, "created_on": "2019-04-23T19:12:24.817419+00:00", "user": {"display_name": "Nate Koenig", "uuid": "{c862cdd9-fcc8-4419-9fc7-e20db14b8fcb}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D"}, "html": {"href": "https://bitbucket.org/%7Bc862cdd9-fcc8-4419-9fc7-e20db14b8fcb%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:095b1e12-74ed-4e20-b44f-2f0745b616e0/ca24bb11-4787-4b14-a20d-d91835e9bde2/128"}}, "nickname": "Nathan Koenig", "type": "user", "account_id": "557058:095b1e12-74ed-4e20-b44f-2f0745b616e0"}, "inline": {}, "updated_on": "2019-04-23T19:12:24.826417+00:00", "type": "pullrequest_comment", "id": 99717909}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "[WIP] Rule of five for various DOM classes", "destination": {"commit": {"hash": "341fec6b9a9b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/341fec6b9a9b.json"}, "html": {"href": "#!/osrf/sdformat/commits/341fec6b9a9b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "5d19002bafc2", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/5d19002bafc2.json"}, "html": {"href": "#!/osrf/sdformat/commits/5d19002bafc2"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2019-04-23T18:57:08.200491+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}, {"update": {"description": "This PR adds missing constructors and assignment operators to various DOM classes to comply with the rule of five. I believe the violation of this rule has led to test failures in [this PR](https://bitbucket.org/ignitionrobotics/ign-gazebo/pull-requests/267/blueprint-remove-pimpl-from-component/diff). The failures are segfaults and they arise when `std::swap` is used in resizing a `std::vector` containing DOM classes (more precisely, ign-gazebo components containing DOM classes).\r\n \r\nHere is possible implementation of `std::swap`: \r\n```\r\nvoid swap(T &_a, T &_b)\r\nT tmp = std::move(_a);\r\n_a = std::move(_b);\r\n_b = std::move(_a);\r\n```\r\nSince a copy assignment is used if a move assignment is missing, some DOM classes will use a move constructor in `T tmp = std::move(_a);` and a copy assignment in `a = std::move(_b)`. This leads to a segfault because the `dataPtr` in `_a` is set to `nullptr` when it was moved from. \r\n\r\nThe fix is to allocate a new `dataPtr` in copy assignment functions if its `nullptr`. Note that this problem wouldn't have surfaced if the class had a move assignment operator, so I added a test that explicitly exercises a copy assignment on an object that has been moved from.", "title": "[WIP] Rule of five for various DOM classes", "destination": {"commit": {"hash": "341fec6b9a9b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/341fec6b9a9b.json"}, "html": {"href": "#!/osrf/sdformat/commits/341fec6b9a9b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "sdf8"}}, "reason": "", "source": {"commit": {"hash": "5d19002bafc2", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/sdformat/commit/5d19002bafc2.json"}, "html": {"href": "#!/osrf/sdformat/commits/5d19002bafc2"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/sdformat.json"}, "html": {"href": "#!/osrf/sdformat"}, "avatar": {"href": "data/bytebucket.org/ravatar/{b6d52f9f-b070-41c0-807c-94af07ea375b}ts=1606789"}}, "type": "repository", "name": "sdformat", "full_name": "osrf/sdformat", "uuid": "{b6d52f9f-b070-41c0-807c-94af07ea375b}"}, "branch": {"name": "dom_rule_of_five"}}, "state": "OPEN", "author": {"display_name": "Addisu Z. Taddese", "uuid": "{9d7fdc68-d270-4080-bf03-4df0d0dbf635}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D"}, "html": {"href": "https://bitbucket.org/%7B9d7fdc68-d270-4080-bf03-4df0d0dbf635%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:90bc87b0-2886-4377-a17c-3a6629a697ff/afbf9be5-1e4c-4810-89d4-e58831f34b11/128"}}, "nickname": "azeey", "type": "user", "account_id": "557058:90bc87b0-2886-4377-a17c-3a6629a697ff"}, "date": "2019-04-23T18:57:08.153229+00:00"}, "pull_request": {"type": "pullrequest", "id": 524, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/524.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/524"}}, "title": "Rule of five for various DOM classes"}}]}