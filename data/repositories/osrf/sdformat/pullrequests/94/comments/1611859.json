{"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/94/comments/1611859.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/94/_/diff#comment-1611859"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 94, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/94.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/94"}}, "title": "Fix make test before make install"}, "content": {"raw": "Looks like it's testing the difference between 1.4 and 1.5 and failing because 1.4 is supposed to default \"use_parent_model_frame\" to true. \n```\n#!c++\n\n////////////////////////////////////////\n// sdf model, version 1.4, use_parent_model_frame tag missing\n// expect tag to be inserted with value true\nTEST(JointAxisFrame, Version_1_4_missing)\n{\n  char *pathCStr = getenv(\"SDF_PATH\");\n  boost::filesystem::path path = PROJECT_SOURCE_PATH;\n  path = path / \"sdf\" / SDF_VERSION;\n  setenv(\"SDF_PATH\", path.string().c_str(), 1);\n\n  sdf::SDFPtr model(new sdf::SDF());\n  sdf::init(model);\n  ASSERT_TRUE(sdf::readString(get_sdf_string(\"1.4\"), model));\n  setenv(\"SDF_PATH\", pathCStr, 1);\n\n  sdf::ElementPtr joint = model->root->GetElement(\"model\")->GetElement(\"joint\");\n  sdf::ElementPtr axis = joint->GetElement(\"axis\");\n  EXPECT_TRUE(axis->HasElement(\"use_parent_model_frame\"));\n  EXPECT_TRUE(axis->Get<bool>(\"use_parent_model_frame\")); // <---------------------------------------------------FAILURE HERE\n}\n```\n", "markup": "markdown", "html": "<p>Looks like it's testing the difference between 1.4 and 1.5 and failing because 1.4 is supposed to default \"use_parent_model_frame\" to true. </p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"c1\">////////////////////////////////////////</span>\n<span class=\"c1\">// sdf model, version 1.4, use_parent_model_frame tag missing</span>\n<span class=\"c1\">// expect tag to be inserted with value true</span>\n<span class=\"n\">TEST</span><span class=\"p\">(</span><span class=\"n\">JointAxisFrame</span><span class=\"p\">,</span> <span class=\"n\">Version_1_4_missing</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n  <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"n\">pathCStr</span> <span class=\"o\">=</span> <span class=\"n\">getenv</span><span class=\"p\">(</span><span class=\"s\">&quot;SDF_PATH&quot;</span><span class=\"p\">);</span>\n  <span class=\"n\">boost</span><span class=\"o\">::</span><span class=\"n\">filesystem</span><span class=\"o\">::</span><span class=\"n\">path</span> <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"n\">PROJECT_SOURCE_PATH</span><span class=\"p\">;</span>\n  <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"n\">path</span> <span class=\"o\">/</span> <span class=\"s\">&quot;sdf&quot;</span> <span class=\"o\">/</span> <span class=\"n\">SDF_VERSION</span><span class=\"p\">;</span>\n  <span class=\"n\">setenv</span><span class=\"p\">(</span><span class=\"s\">&quot;SDF_PATH&quot;</span><span class=\"p\">,</span> <span class=\"n\">path</span><span class=\"p\">.</span><span class=\"n\">string</span><span class=\"p\">().</span><span class=\"n\">c_str</span><span class=\"p\">(),</span> <span class=\"mi\">1</span><span class=\"p\">);</span>\n\n  <span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">SDFPtr</span> <span class=\"n\">model</span><span class=\"p\">(</span><span class=\"k\">new</span> <span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">SDF</span><span class=\"p\">());</span>\n  <span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">init</span><span class=\"p\">(</span><span class=\"n\">model</span><span class=\"p\">);</span>\n  <span class=\"n\">ASSERT_TRUE</span><span class=\"p\">(</span><span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">readString</span><span class=\"p\">(</span><span class=\"n\">get_sdf_string</span><span class=\"p\">(</span><span class=\"s\">&quot;1.4&quot;</span><span class=\"p\">),</span> <span class=\"n\">model</span><span class=\"p\">));</span>\n  <span class=\"n\">setenv</span><span class=\"p\">(</span><span class=\"s\">&quot;SDF_PATH&quot;</span><span class=\"p\">,</span> <span class=\"n\">pathCStr</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">);</span>\n\n  <span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">ElementPtr</span> <span class=\"n\">joint</span> <span class=\"o\">=</span> <span class=\"n\">model</span><span class=\"o\">-&gt;</span><span class=\"n\">root</span><span class=\"o\">-&gt;</span><span class=\"n\">GetElement</span><span class=\"p\">(</span><span class=\"s\">&quot;model&quot;</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"n\">GetElement</span><span class=\"p\">(</span><span class=\"s\">&quot;joint&quot;</span><span class=\"p\">);</span>\n  <span class=\"n\">sdf</span><span class=\"o\">::</span><span class=\"n\">ElementPtr</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"n\">joint</span><span class=\"o\">-&gt;</span><span class=\"n\">GetElement</span><span class=\"p\">(</span><span class=\"s\">&quot;axis&quot;</span><span class=\"p\">);</span>\n  <span class=\"n\">EXPECT_TRUE</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">-&gt;</span><span class=\"n\">HasElement</span><span class=\"p\">(</span><span class=\"s\">&quot;use_parent_model_frame&quot;</span><span class=\"p\">));</span>\n  <span class=\"n\">EXPECT_TRUE</span><span class=\"p\">(</span><span class=\"n\">axis</span><span class=\"o\">-&gt;</span><span class=\"n\">Get</span><span class=\"o\">&lt;</span><span class=\"kt\">bool</span><span class=\"o\">&gt;</span><span class=\"p\">(</span><span class=\"s\">&quot;use_parent_model_frame&quot;</span><span class=\"p\">));</span> <span class=\"c1\">// &lt;---------------------------------------------------FAILURE HERE</span>\n<span class=\"p\">}</span>\n</pre></div>", "type": "rendered"}, "created_on": "2014-04-08T19:43:18.562226+00:00", "user": {"display_name": "andy_somerville", "uuid": "{09fd5d4b-d90e-4416-9a6a-2e5cd638472c}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B09fd5d4b-d90e-4416-9a6a-2e5cd638472c%7D"}, "html": {"href": "https://bitbucket.org/%7B09fd5d4b-d90e-4416-9a6a-2e5cd638472c%7D/"}, "avatar": {"href": "https://bitbucket.org/account/andy_somerville/avatar/"}}, "nickname": "andy_somerville", "type": "user", "account_id": null}, "updated_on": "2014-04-08T19:43:18.709818+00:00", "type": "pullrequest_comment", "id": 1611859}