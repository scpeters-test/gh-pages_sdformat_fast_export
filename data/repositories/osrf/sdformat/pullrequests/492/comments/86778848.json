{"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/492/comments/86778848.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/492/_/diff#comment-86778848"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 492, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/492.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/492"}}, "title": "Fix locale problems of std::stringstream and of Param::ValueFromString"}, "content": {"raw": "~~I removed the~~ `std::setlocale` ~~call in~~ `bool Param::SetFromString(const std::string &_value)` ~~, as it is not necessary anymore now that we use properly imbued std::stringstream objects.   \n Strictly speaking this is a change of behavior of the library: the C locale is a global state of the process, and so if downstream codes assuming that the C locale is switched to~~ `\"C\"` ~~after a call, it may be broken by this change.  \n However, I do not think that it is possible to properly deprecate this behavior in a useful way, such that any code that relies on the C locale being switched to~~ `\"C\"` ~~could receive a warning or something like that. However, let me know if instead you prefer to restore the~~ `std::setlocale` ~~call.~~\n\nOutdated comment, see the rest of the PR.\n\nRelated issues in other projects:\n\n* [https://github.com/ros/urdfdom/issues/98](https://github.com/ros/urdfdom/issues/98)\n* [https://github.com/robotology/idyntree/issues/288](https://github.com/robotology/idyntree/issues/288)\n* [https://github.com/RobotLocomotion/drake/pull/10326](https://github.com/RobotLocomotion/drake/pull/10326)\n\n", "markup": "markdown", "html": "<p><del>I removed the</del> <code>std::setlocale</code> <del>call in</del> <code>bool Param::SetFromString(const std::string &amp;_value)</code> <del>, as it is not necessary anymore now that we use properly imbued std::stringstream objects. <br />\n Strictly speaking this is a change of behavior of the library: the C locale is a global state of the process, and so if downstream codes assuming that the C locale is switched to</del> <code>\"C\"</code> <del>after a call, it may be broken by this change.<br />\n However, I do not think that it is possible to properly deprecate this behavior in a useful way, such that any code that relies on the C locale being switched to</del> <code>\"C\"</code> <del>could receive a warning or something like that. However, let me know if instead you prefer to restore the</del> <code>std::setlocale</code> <del>call.</del></p>\n<p>Outdated comment, see the rest of the PR.</p>\n<p>Related issues in other projects:</p>\n<ul>\n<li><a data-is-external-link=\"true\" href=\"https://github.com/ros/urdfdom/issues/98\" rel=\"nofollow\">https://github.com/ros/urdfdom/issues/98</a></li>\n<li><a data-is-external-link=\"true\" href=\"https://github.com/robotology/idyntree/issues/288\" rel=\"nofollow\">https://github.com/robotology/idyntree/issues/288</a></li>\n<li><a data-is-external-link=\"true\" href=\"https://github.com/RobotLocomotion/drake/pull/10326\" rel=\"nofollow\">https://github.com/RobotLocomotion/drake/pull/10326</a></li>\n</ul>", "type": "rendered"}, "created_on": "2018-12-30T00:04:53.259644+00:00", "user": {"display_name": "Silvio Traversaro", "uuid": "{34f404cb-5642-4f27-a032-e04c7143d776}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D"}, "html": {"href": "https://bitbucket.org/%7B34f404cb-5642-4f27-a032-e04c7143d776%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6/578caaa1-056c-45a2-8bf9-bee94c3bebef/128"}}, "nickname": "traversaro", "type": "user", "account_id": "557058:e1c3e6a0-9a64-4e5f-a668-feebc191c5b6"}, "updated_on": "2018-12-30T08:29:11.587685+00:00", "type": "pullrequest_comment", "id": 86778848}