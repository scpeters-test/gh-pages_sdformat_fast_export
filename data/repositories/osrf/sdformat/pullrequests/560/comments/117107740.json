{"links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/560/comments/117107740.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/560/_/diff#comment-117107740"}}, "parent": {"id": 117105007, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/560/comments/117105007.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/560/_/diff#comment-117105007"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 560, "links": {"self": {"href": "data/repositories/osrf/sdformat/pullrequests/560.json"}, "html": {"href": "#!/osrf/sdformat/pull-requests/560"}}, "title": "WIP: Frame semantics for sdf 1.7"}, "content": {"raw": "Doing some debugging with this patch, it looks like the graph is passed in, but somehow either the `weak_ptr` is lost, or the `shared_ptr` is somehow invalidated from when the link\u2019s graph is checked to when the viz graph is checked? Injecting print statements in `libsdformat`:\n\n```\n[ RUN      ] MultibodyPlantSdfParserTest.PackageMapSpecified\nlink set graph: box - 0x556f7b830e10\nviz set graph: visual - 0x556f7b830e10\n  this: 0x556f7b644670\n[2019-09-17 01:37:42.606] [console] [info] resolve link pose\nlink resolve graph: 0x556f7b830e10\n[2019-09-17 01:37:42.607] [console] [info] resolve viz pose\nviz resolve graph: 0\n  this: 0x7ffde0f59cb0\nunknown file: Failure\nC++ exception with description \"From AddModelFromSdfFile():\nError: Visual with name [visual] has invalid pointer to PoseRelativeToGraph.\n```\n\n\u200c", "markup": "markdown", "html": "<p>Doing some debugging with this patch, it looks like the graph is passed in, but somehow either the <code>weak_ptr</code> is lost, or the <code>shared_ptr</code> is somehow invalidated from when the link\u2019s graph is checked to when the viz graph is checked? Injecting print statements in <code>libsdformat</code>:</p>\n<div class=\"codehilite\"><pre><span></span>[ RUN      ] MultibodyPlantSdfParserTest.PackageMapSpecified\nlink set graph: box - 0x556f7b830e10\nviz set graph: visual - 0x556f7b830e10\n  this: 0x556f7b644670\n[2019-09-17 01:37:42.606] [console] [info] resolve link pose\nlink resolve graph: 0x556f7b830e10\n[2019-09-17 01:37:42.607] [console] [info] resolve viz pose\nviz resolve graph: 0\n  this: 0x7ffde0f59cb0\nunknown file: Failure\nC++ exception with description &quot;From AddModelFromSdfFile():\nError: Visual with name [visual] has invalid pointer to PoseRelativeToGraph.\n</pre></div>\n\n\n<p>\u200c</p>", "type": "rendered"}, "created_on": "2019-09-17T01:32:36.960198+00:00", "user": {"display_name": "Eric Cousineau", "uuid": "{71c9fc05-02c8-45e1-adfa-13c8ac3399dc}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D"}, "html": {"href": "https://bitbucket.org/%7B71c9fc05-02c8-45e1-adfa-13c8ac3399dc%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557057:f3a199b9-5784-4964-9644-6ef224bc7dc1/28a4d748-0fd4-4038-bf3d-55a77eb73ede/128"}}, "nickname": "eacousineau", "type": "user", "account_id": "557057:f3a199b9-5784-4964-9644-6ef224bc7dc1"}, "updated_on": "2019-09-17T01:39:52.020773+00:00", "type": "pullrequest_comment", "id": 117107740}